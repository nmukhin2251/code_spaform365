/*1.0.8.3*/ define("text",["module"],function(e){"use strict";var t,i,n,a,r,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],s=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,l=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,d="undefined"!=typeof location&&location.href,c=d&&location.protocol&&location.protocol.replace(/\:/,""),u=d&&location.hostname,m=d&&(location.port||void 0),p={},h=e.config&&e.config()||{};return t={version:"2.0.14",strip:function(e){if(e){e=e.replace(s,"");var t=e.match(l);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:h.createXhr||function(){var e,t,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;t<3;t+=1){i=o[t];try{e=new ActiveXObject(i)}catch(e){}if(e){o=[i];break}}return e},parseName:function(e){var t,i,n,a=!1,r=e.lastIndexOf("."),o=0===e.indexOf("./")||0===e.indexOf("../");return-1!==r&&(!o||r>1)?(t=e.substring(0,r),i=e.substring(r+1)):t=e,n=i||t,r=n.indexOf("!"),-1!==r&&(a="strip"===n.substring(r+1),n=n.substring(0,r),i?i=n:t=n),{moduleName:t,ext:i,strip:a}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,i,n,a){var r,o,s,l=t.xdRegExp.exec(e);return!l||(r=l[2],o=l[3],o=o.split(":"),s=o[1],o=o[0],!(r&&r!==i||o&&o.toLowerCase()!==n.toLowerCase()||(s||o)&&s!==a))},finishLoad:function(e,i,n,a){n=i?t.strip(n):n,h.isBuild&&(p[e]=n),a(n)},load:function(e,i,n,a){if(a&&a.isBuild&&!a.inlineText)return void n();h.isBuild=a&&a.isBuild;var r=t.parseName(e),o=r.moduleName+(r.ext?"."+r.ext:""),s=i.toUrl(o),l=h.useXhr||t.useXhr;if(0===s.indexOf("empty:"))return void n();!d||l(s,c,u,m)?t.get(s,function(i){t.finishLoad(e,r.strip,i,n)},function(e){n.error&&n.error(e)}):i([o],function(e){t.finishLoad(r.moduleName+"."+r.ext,r.strip,e,n)})},write:function(e,i,n,a){if(p.hasOwnProperty(i)){var r=t.jsEscape(p[i]);n.asModule(e+"!"+i,"define(function () { return '"+r+"';});\n")}},writeFile:function(e,i,n,a,r){var o=t.parseName(i),s=o.ext?"."+o.ext:"",l=o.moduleName+s,d=n.toUrl(o.moduleName+s)+".js";t.load(l,n,function(i){var n=function(e){return a(d,e)};n.asModule=function(e,t){return a.asModule(e,d,t)},t.write(e,l,n,r)},r)}},"node"===h.env||!h.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(i=require.nodeRequire("fs"),t.get=function(e,t,n){try{var a=i.readFileSync(e,"utf8");"\ufeff"===a[0]&&(a=a.substring(1)),t(a)}catch(e){n&&n(e)}}):"xhr"===h.env||!h.env&&t.createXhr()?t.get=function(e,i,n,a){var r,o=t.createXhr();if(o.open("GET",e,!0),a)for(r in a)a.hasOwnProperty(r)&&o.setRequestHeader(r.toLowerCase(),a[r]);h.onXhr&&h.onXhr(o,e),o.onreadystatechange=function(t){var a,r;4===o.readyState&&(a=o.status||0,a>399&&a<600?(r=new Error(e+" HTTP status: "+a),r.xhr=o,n&&n(r)):i(o.responseText),h.onXhrComplete&&h.onXhrComplete(o,e))},o.send(null)}:"rhino"===h.env||!h.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var i,n,a=new java.io.File(e),r=java.lang.System.getProperty("line.separator"),o=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(a),"utf-8")),s="";try{for(i=new java.lang.StringBuffer,n=o.readLine(),n&&n.length()&&65279===n.charAt(0)&&(n=n.substring(1)),null!==n&&i.append(n);null!==(n=o.readLine());)i.append(r),i.append(n);s=String(i.toString())}finally{o.close()}t(s)}:("xpconnect"===h.env||!h.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(n=Components.classes,a=Components.interfaces,Components.utils.import("resource://gre/modules/FileUtils.jsm"),r="@mozilla.org/windows-registry-key;1"in n,t.get=function(e,t){var i,o,s,l={};r&&(e=e.replace(/\//g,"\\")),s=new FileUtils.File(e);try{i=n["@mozilla.org/network/file-input-stream;1"].createInstance(a.nsIFileInputStream),i.init(s,1,0,!1),o=n["@mozilla.org/intl/converter-input-stream;1"].createInstance(a.nsIConverterInputStream),o.init(i,"utf-8",i.available(),a.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(i.available(),l),o.close(),i.close(),t(l.value)}catch(e){throw new Error((s&&s.path||"")+": "+e)}}),t}),function(e){"function"==typeof define&&define.amd?define("picker",["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):this.Picker=e(jQuery)}(function(e){function t(r,o,s,c){function u(){return t._.node("div",t._.node("div",t._.node("div",t._.node("div",w.component.nodes(v.open),x.box),x.wrap),x.frame),x.holder)}function m(){k.data(o,w).addClass(x.input).val(k.data("value")?w.get("select",g.format):r.value).on("focus."+v.id+" click."+v.id,f),g.editable||k.on("keydown."+v.id,function(e){var t=e.keyCode,i=/^(8|46)$/.test(t);return 27==t?(w.close(),!1):void((32==t||i||!v.open&&w.component.key[t])&&(e.preventDefault(),e.stopPropagation(),i?w.clear().close():w.open()))}),a(r,{haspopup:!0,expanded:!1,readonly:!1,owns:r.id+"_root"+(w._hidden?" "+w._hidden.id:"")})}function p(){w.$root.on({focusin:function(e){w.$root.removeClass(x.focused),e.stopPropagation()},"mousedown click":function(t){var i=t.target;i!=w.$root.children()[0]&&(t.stopPropagation(),"mousedown"!=t.type||e(i).is(":input")||"OPTION"==i.nodeName||(t.preventDefault(),r.focus()))}}).on("click","[data-pick], [data-nav], [data-clear], [data-close]",function(){var t=e(this),i=t.data(),n=t.hasClass(x.navDisabled)||t.hasClass(x.disabled),a=document.activeElement;a=a&&(a.type||a.href)&&a,(n||a&&!e.contains(w.$root[0],a))&&r.focus(),!n&&i.nav?w.set("highlight",w.component.item.highlight,{nav:i.nav}):!n&&"pick"in i?w.set("select",i.pick).close(!0):i.clear?w.clear().close(!0):i.close&&w.close(!0)}),a(w.$root[0],"hidden",!0)}function h(){var t;!0===g.hiddenName?(t=r.name,r.name=""):(t=["string"==typeof g.hiddenPrefix?g.hiddenPrefix:"","string"==typeof g.hiddenSuffix?g.hiddenSuffix:"_submit"],t=t[0]+r.name+t[1]),w._hidden=e('<input type=hidden name="'+t+'"'+(k.data("value")||r.value?' value="'+w.get("select",g.formatSubmit)+'"':"")+">")[0],k.on("change."+v.id,function(){w._hidden.value=r.value?w.get("select",g.formatSubmit):""}).after(w._hidden)}function f(e){e.stopPropagation(),"focus"==e.type&&w.$root.addClass(x.focused),w.open()}if(!r)return t;var b=!1,v={id:r.id||"P"+Math.abs(~~(Math.random()*new Date))},g=s?e.extend(!0,{},s.defaults,c):c||{},x=e.extend({},t.klasses(),g.klass),k=e(r),y=function(){return this.start()},w=y.prototype={constructor:y,$node:k,start:function(){return v&&v.start?w:(v.methods={},v.start=!0,v.open=!1,v.type=r.type,r.autofocus=r==document.activeElement,r.readOnly=!g.editable,r.id=r.id||v.id,"text"!=r.type&&(r.type="text"),w.component=new s(w,g),w.$root=e(t._.node("div",u(),x.picker,'id="'+r.id+'_root"')),p(),g.formatSubmit&&h(),m(),g.container?e(g.container).append(w.$root):k.after(w.$root),w.on({start:w.component.onStart,render:w.component.onRender,stop:w.component.onStop,open:w.component.onOpen,close:w.component.onClose,set:w.component.onSet}).on({start:g.onStart,render:g.onRender,stop:g.onStop,open:g.onOpen,close:g.onClose,set:g.onSet}),b=i(w.$root.children()[0]),r.autofocus&&w.open(),w.trigger("start").trigger("render"))},render:function(e){return e?w.$root.html(u()):w.$root.find("."+x.box).html(w.component.nodes(v.open)),w.trigger("render")},stop:function(){return v.start?(w.close(),w._hidden&&w._hidden.parentNode.removeChild(w._hidden),w.$root.remove(),k.removeClass(x.input).removeData(o),setTimeout(function(){k.off("."+v.id)},0),r.type=v.type,r.readOnly=!1,w.trigger("stop"),v.methods={},v.start=!1,w):w},open:function(i){return v.open?w:(k.addClass(x.active),a(r,"expanded",!0),setTimeout(function(){w.$root.addClass(x.opened),a(w.$root[0],"hidden",!1)},0),!1!==i&&(v.open=!0,b&&d.css("overflow","hidden").css("padding-right","+="+n()),k.trigger("focus"),l.on("click."+v.id+" focusin."+v.id,function(e){var t=e.target;t!=r&&t!=document&&3!=e.which&&w.close(t===w.$root.children()[0])}).on("keydown."+v.id,function(i){var n=i.keyCode,a=w.component.key[n],o=i.target;27==n?w.close(!0):o!=r||!a&&13!=n?e.contains(w.$root[0],o)&&13==n&&(i.preventDefault(),o.click()):(i.preventDefault(),a?t._.trigger(w.component.key.go,w,[t._.trigger(a)]):w.$root.find("."+x.highlighted).hasClass(x.disabled)||w.set("select",w.component.item.highlight).close())})),w.trigger("open"))},close:function(e){return e&&(k.off("focus."+v.id).trigger("focus"),setTimeout(function(){k.on("focus."+v.id,f)},0)),k.removeClass(x.active),a(r,"expanded",!1),setTimeout(function(){w.$root.removeClass(x.opened+" "+x.focused),a(w.$root[0],"hidden",!0)},0),v.open?(v.open=!1,b&&d.css("overflow","").css("padding-right","-="+n()),l.off("."+v.id),w.trigger("close")):w},clear:function(e){return w.set("clear",null,e)},set:function(t,i,n){var a,r,o=e.isPlainObject(t),s=o?t:{};if(n=o&&e.isPlainObject(i)?i:n||{},t){o||(s[t]=i);for(a in s)r=s[a],a in w.component.item&&(void 0===r&&(r=null),w.component.set(a,r,n)),("select"==a||"clear"==a)&&k.val("clear"==a?"":w.get(a,g.format)).trigger("change");w.render()}return n.muted?w:w.trigger("set",s)},get:function(e,i){if(e=e||"value",null!=v[e])return v[e];if("value"==e)return r.value;if(e in w.component.item){if("string"==typeof i){var n=w.component.get(e);return n?t._.trigger(w.component.formats.toString,w.component,[i,n]):""}return w.component.get(e)}},on:function(t,i,n){var a,r,o=e.isPlainObject(t),s=o?t:{};if(t){o||(s[t]=i);for(a in s)r=s[a],n&&(a="_"+a),v.methods[a]=v.methods[a]||[],v.methods[a].push(r)}return w},off:function(){var e,t,i=arguments;for(e=0,namesCount=i.length;namesCount>e;e+=1)(t=i[e])in v.methods&&delete v.methods[t];return w},trigger:function(e,i){var n=function(e){var n=v.methods[e];n&&n.map(function(e){t._.trigger(e,w,[i])})};return n("_"+e),n(e),w}};return new y}function i(e){var t,i="position";return e.currentStyle?t=e.currentStyle[i]:window.getComputedStyle&&(t=getComputedStyle(e)[i]),"fixed"==t}function n(){if(d.height()<=s.height())return 0;var t=e('<div style="visibility:hidden;width:100px" />').appendTo("body"),i=t[0].offsetWidth;t.css("overflow","scroll");var n=e('<div style="width:100%" />').appendTo(t),a=n[0].offsetWidth;return t.remove(),i-a}function a(t,i,n){if(e.isPlainObject(i))for(var a in i)r(t,a,i[a]);else r(t,i,n)}function r(e,t,i){e.setAttribute(("role"==t?"":"aria-")+t,i)}function o(t,i){e.isPlainObject(t)||(t={attribute:i}),i="";for(var n in t){var a=("role"==n?"":"aria-")+n;i+=null==t[n]?"":a+'="'+t[n]+'"'}return i}var s=e(window),l=e(document),d=e(document.documentElement);return t.klasses=function(e){return e=e||"picker",{picker:e,opened:e+"--opened",focused:e+"--focused",input:e+"__input",active:e+"__input--active",holder:e+"__holder",frame:e+"__frame",wrap:e+"__wrap",box:e+"__box"}},t._={group:function(e){for(var i,n="",a=t._.trigger(e.min,e);a<=t._.trigger(e.max,e,[a]);a+=e.i)i=t._.trigger(e.item,e,[a]),n+=t._.node(e.node,i[0],i[1],i[2]);return n},node:function(t,i,n,a){return i?(i=e.isArray(i)?i.join(""):i,n=n?' class="'+n+'"':"",a=a?" "+a:"","<"+t+n+a+">"+i+"</"+t+">"):""},lead:function(e){return(10>e?"0":"")+e},trigger:function(e,t,i){return"function"==typeof e?e.apply(t,i||[]):e},digits:function(e){return/\d/.test(e[1])?2:1},isDate:function(e){return{}.toString.call(e).indexOf("Date")>-1&&this.isInteger(e.getUTCDate())},isInteger:function(e){return{}.toString.call(e).indexOf("Number")>-1&&e%1==0},ariaAttr:o},t.extend=function(i,n){e.fn[i]=function(a,r){var o=this.data(i);return"picker"==a?o:o&&"string"==typeof a?t._.trigger(o[a],o,[r]):this.each(function(){e(this).data(i)||new t(this,i,n,a)})},e.fn[i].defaults=n.defaults},t}),function(e){"function"==typeof define&&define.amd?define("../Runtime/source/syscomponents/pickadate",["picker","jquery"],e):"object"==typeof exports?module.exports=e(require("./picker.js"),require("jquery")):e(Picker,jQuery)}(function(e,t){function i(e,t){var i=this,n=e.$node[0],a=n.value,r=e.$node.data("value"),o=r||a,s=r?t.formatSubmit:t.format,l=function(){return n.currentStyle?"rtl"==n.currentStyle.direction:"rtl"==getComputedStyle(e.$root[0]).direction};i.settings=t,i.$node=e.$node,i.queue={min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"parse navigate create validate",view:"parse create validate viewset",disable:"deactivate",enable:"activate"},i.item={},i.item.clear=null,i.item.disable=(t.disable||[]).slice(0),i.item.enable=-function(e){return!0===e[0]?e.shift():-1}(i.item.disable),i.set("min",t.min).set("max",t.max).set("now"),o?i.set("select",o,{format:s}):i.set("select",null).set("highlight",i.item.now),i.key={40:7,38:-7,39:function(){return l()?-1:1},37:function(){return l()?1:-1},go:function(e){var t=i.item.highlight,n=new Date(Date.UTC(t.year,t.month,t.date+e));i.set("highlight",n,{interval:e}),this.render()}},e.on("render",function(){e.$root.find("."+t.klass.selectMonth).on("change",function(){var i=this.value;i&&(e.set("highlight",[e.get("view").year,i,e.get("highlight").date]),e.$root.find("."+t.klass.selectMonth).trigger("focus"))}),e.$root.find("."+t.klass.selectYear).on("change",function(){var i=this.value;i&&(e.set("highlight",[i,e.get("view").month,e.get("highlight").date]),e.$root.find("."+t.klass.selectYear).trigger("focus"))})},1).on("open",function(){var n="";i.disabled(i.get("now"))&&(n=":not(."+t.klass.buttonToday+")"),e.$root.find("button"+n+", select").attr("disabled",!1)},1).on("close",function(){e.$root.find("button, select").attr("disabled",!0)},1)}var n=e._;i.prototype.set=function(e,t,i){var n=this,a=n.item;return null===t?("clear"==e&&(e="select"),a[e]=t,n):(a["enable"==e?"disable":"flip"==e?"enable":e]=n.queue[e].split(" ").map(function(a){return t=n[a](e,t,i)}).pop(),"select"==e?n.set("highlight",a.select,i):"highlight"==e?n.set("view",a.highlight,i):e.match(/^(flip|min|max|disable|enable)$/)&&(a.select&&n.disabled(a.select)&&n.set("select",a.select,i),a.highlight&&n.disabled(a.highlight)&&n.set("highlight",a.highlight,i)),n)},i.prototype.get=function(e){return this.item[e]},i.prototype.create=function(e,i,a){var r,o=this;return i=void 0===i?e:i,i==-1/0||1/0==i?r=i:t.isPlainObject(i)&&n.isInteger(i.pick)?i=i.obj:t.isArray(i)?(i=new Date(Date.UTC(i[0],i[1],i[2])),i=n.isDate(i)?i:o.create().obj):i=n.isInteger(i)?o.normalize(new Date(i),a):n.isDate(i)?o.normalize(i,a):o.now(e,i,a),{year:r||i.getUTCFullYear(),month:r||i.getUTCMonth(),date:r||i.getUTCDate(),day:r||i.getUTCDay(),obj:r||i,pick:r||i.getTime()}},i.prototype.createRange=function(e,i){var a=this,r=function(e){return!0===e||t.isArray(e)||n.isDate(e)?a.create(e):e};return n.isInteger(e)||(e=r(e)),n.isInteger(i)||(i=r(i)),n.isInteger(e)&&t.isPlainObject(i)?e=[i.year,i.month,i.date+e]:n.isInteger(i)&&t.isPlainObject(e)&&(i=[e.year,e.month,e.date+i]),{from:r(e),to:r(i)}},i.prototype.withinRange=function(e,t){return e=this.createRange(e.from,e.to),t.pick>=e.from.pick&&t.pick<=e.to.pick},i.prototype.overlapRanges=function(e,t){var i=this;return e=i.createRange(e.from,e.to),t=i.createRange(t.from,t.to),i.withinRange(e,t.from)||i.withinRange(e,t.to)||i.withinRange(t,e.from)||i.withinRange(t,e.to)},i.prototype.now=function(e,t,i){return t=new Date,i&&i.rel&&t.setUTCDate(t.getUTCDate()+i.rel),this.normalize(t,i)},i.prototype.navigate=function(e,i,n){var a,r,o,s,l=t.isArray(i),d=t.isPlainObject(i),c=this.item.view;if(l||d){for(d?(r=i.year,o=i.month,s=i.date):(r=+i[0],o=+i[1],s=+i[2]),n&&n.nav&&c&&c.month!==o&&(r=c.year,o=c.month),a=new Date(Date.UTC(r,o+(n&&n.nav?n.nav:0),1)),r=a.getUTCFullYear(),o=a.getUTCMonth();new Date(Date.UTC(r,o,s)).getUTCMonth()!==o;)s-=1;i=[r,o,s]}return i},i.prototype.normalize=function(e){return e.setUTCHours(0,0,0,0),e},i.prototype.measure=function(e,t){var i=this;return t?"string"==typeof t?t=i.parse(e,t):n.isInteger(t)&&(t=i.now(e,t,{rel:t})):t="min"==e?-1/0:1/0,t},i.prototype.viewset=function(e,t){return this.create([t.year,t.month,1])},i.prototype.validate=function(e,i,a){var r,o,s,l,d=this,c=i,u=a&&a.interval?a.interval:1,m=-1===d.item.enable,p=d.item.min,h=d.item.max,f=m&&d.item.disable.filter(function(e){if(t.isArray(e)){var a=d.create(e).pick;a<i.pick?r=!0:a>i.pick&&(o=!0)}return n.isInteger(e)}).length;if((!a||!a.nav)&&(!m&&d.disabled(i)||m&&d.disabled(i)&&(f||r||o)||!m&&(i.pick<=p.pick||i.pick>=h.pick)))for(m&&!f&&(!o&&u>0||!r&&0>u)&&(u*=-1);d.disabled(i)&&(Math.abs(u)>1&&(i.month<c.month||i.month>c.month)&&(i=c,u=u>0?1:-1),i.pick<=p.pick?(s=!0,u=1,i=d.create([p.year,p.month,p.date+(i.pick===p.pick?0:-1)])):i.pick>=h.pick&&(l=!0,u=-1,i=d.create([h.year,h.month,h.date+(i.pick===h.pick?0:1)])),!s||!l);)i=d.create([i.year,i.month,i.date+u]);return i},i.prototype.disabled=function(e){var i=this,a=i.item.disable.filter(function(a){return n.isInteger(a)?e.day===(i.settings.firstDay?a:a-1)%7:t.isArray(a)||n.isDate(a)?e.pick===i.create(a).pick:t.isPlainObject(a)?i.withinRange(a,e):void 0});return a=a.length&&!a.filter(function(e){return t.isArray(e)&&"inverted"==e[3]||t.isPlainObject(e)&&e.inverted}).length,-1===i.item.enable?!a:a||e.pick<i.item.min.pick||e.pick>i.item.max.pick},i.prototype.parse=function(e,t,i){var a=this,r={};return t&&"string"==typeof t?(i&&i.format||(i=i||{},i.format=a.settings.format),a.formats.toArray(i.format).map(function(e){var i=a.formats[e],o=i?n.trigger(i,a,[t,r]):e.replace(/^!/,"").length;i&&(r[e]=t.substr(0,o)),t=t.substr(o)}),[r.yyyy||r.yy,+(r.mm||r.m)-1,r.dd||r.d]):t},i.prototype.formats=function(){function e(e,t,i){var n=e.match(/\w+/)[0];return i.mm||i.m||(i.m=t.indexOf(n)+1),n.length}function t(e){return e.match(/\w+/)[0].length}return{d:function(e,t){return e?n.digits(e):t.date},dd:function(e,t){return e?2:n.lead(t.date)},ddd:function(e,i){return e?t(e):this.settings.weekdaysShort[i.day]},dddd:function(e,i){return e?t(e):this.settings.weekdaysFull[i.day]},m:function(e,t){return e?n.digits(e):t.month+1},mm:function(e,t){return e?2:n.lead(t.month+1)},mmm:function(t,i){var n=this.settings.monthsShort;return t?e(t,n,i):n[i.month]},mmmm:function(t,i){var n=this.settings.monthsFull;return t?e(t,n,i):n[i.month]},yy:function(e,t){return e?2:(""+t.year).slice(2)},yyyy:function(e,t){return e?4:t.year},toArray:function(e){return e.split(/(d{1,4}|m{1,4}|y{4}|yy|!.)/g)},toString:function(e,t){var i=this;return i.formats.toArray(e).map(function(e){return n.trigger(i.formats[e],i,[0,t])||e.replace(/^!/,"")}).join("")}}}(),i.prototype.isDateExact=function(e,i){var a=this;return n.isInteger(e)&&n.isInteger(i)||"boolean"==typeof e&&"boolean"==typeof i?e===i:(n.isDate(e)||t.isArray(e))&&(n.isDate(i)||t.isArray(i))?a.create(e).pick===a.create(i).pick:!(!t.isPlainObject(e)||!t.isPlainObject(i))&&(a.isDateExact(e.from,i.from)&&a.isDateExact(e.to,i.to))},i.prototype.isDateOverlap=function(e,i){var a=this,r=a.settings.firstDay?1:0;return n.isInteger(e)&&(n.isDate(i)||t.isArray(i))?(e=e%7+r)===a.create(i).day+1:n.isInteger(i)&&(n.isDate(e)||t.isArray(e))?(i=i%7+r)===a.create(e).day+1:!(!t.isPlainObject(e)||!t.isPlainObject(i))&&a.overlapRanges(e,i)},i.prototype.flipEnable=function(e){var t=this.item;t.enable=e||(-1==t.enable?1:-1)},i.prototype.deactivate=function(e,i){var a=this,r=a.item.disable.slice(0);return"flip"==i?a.flipEnable():!1===i?(a.flipEnable(1),r=[]):!0===i?(a.flipEnable(-1),r=[]):i.map(function(e){for(var i,o=0;o<r.length;o+=1)if(a.isDateExact(e,r[o])){i=!0;break}i||(n.isInteger(e)||n.isDate(e)||t.isArray(e)||t.isPlainObject(e)&&e.from&&e.to)&&r.push(e)}),r},i.prototype.activate=function(e,i){var a=this,r=a.item.disable,o=r.length;return"flip"==i?a.flipEnable():!0===i?(a.flipEnable(1),r=[]):!1===i?(a.flipEnable(-1),r=[]):i.map(function(e){var i,s,l,d;for(l=0;o>l;l+=1){if(s=r[l],a.isDateExact(s,e)){i=r[l]=null,d=!0;break}if(a.isDateOverlap(s,e)){t.isPlainObject(e)?(e.inverted=!0,i=e):t.isArray(e)?(i=e,i[3]||i.push("inverted")):n.isDate(e)&&(i=[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),"inverted"]);break}}if(i)for(l=0;o>l;l+=1)if(a.isDateExact(r[l],e)){r[l]=null;break}if(d)for(l=0;o>l;l+=1)if(a.isDateOverlap(r[l],e)){r[l]=null;break}i&&r.push(i)}),r.filter(function(e){return null!=e})},i.prototype.nodes=function(e){var t=this,i=t.settings,a=t.item,r=a.now,o=a.select,s=a.highlight,l=a.view,d=a.disable,c=a.min,u=a.max,m=function(e,t){return i.firstDay&&(e.push(e.shift()),t.push(t.shift())),n.node("thead",n.node("tr",n.group({min:0,max:6,i:1,node:"th",item:function(n){return[e[n],i.klass.weekdays,'scope=col title="'+t[n]+'"']}})))}((i.showWeekdaysFull?i.weekdaysFull:i.weekdaysShort).slice(0),i.weekdaysFull.slice(0)),p=function(e){return n.node("div"," ",i.klass["nav"+(e?"Next":"Prev")]+(e&&l.year>=u.year&&l.month>=u.month||!e&&l.year<=c.year&&l.month<=c.month?" "+i.klass.navDisabled:""),"data-nav="+(e||-1)+" "+n.ariaAttr({role:"button",components:t.$node[0].id+"_table"})+' title="'+(e?i.labelMonthNext:i.labelMonthPrev)+'"')},h=function(){var a=i.showMonthsShort?i.monthsShort:i.monthsFull;return i.selectMonths?n.node("select",n.group({min:0,max:11,i:1,node:"option",item:function(e){return[a[e],0,"value="+e+(l.month==e?" selected":"")+(l.year==c.year&&e<c.month||l.year==u.year&&e>u.month?" disabled":"")]}}),i.klass.selectMonth,(e?"":"disabled")+" "+n.ariaAttr({components:t.$node[0].id+"_table"})+' title="'+i.labelMonthSelect+'"'):n.node("div",a[l.month],i.klass.month)},f=function(){var a=l.year,r=!0===i.selectYears?5:~~(i.selectYears/2);if(r){var o=c.year,s=u.year,d=a-r,m=a+r;if(o>d&&(m+=o-d,d=o),m>s){var p=d-o,h=m-s;d-=p>h?h:p,m=s}return n.node("select",n.group({min:d,max:m,i:1,node:"option",item:function(e){return[e,0,"value="+e+(a==e?" selected":"")]}}),i.klass.selectYear,(e?"":"disabled")+" "+n.ariaAttr({components:t.$node[0].id+"_table"})+' title="'+i.labelYearSelect+'"')}return n.node("div",a,i.klass.year)};return n.node("div",(i.selectYears?f()+h():h()+f())+p()+p(1),i.klass.header)+n.node("table",m+n.node("tbody",n.group({min:0,max:5,i:1,node:"tr",item:function(e){var a=i.firstDay&&0===t.create([l.year,l.month,1]).day?-7:0;return[n.group({min:7*e-l.day+a+1,max:function(){return this.min+7-1},i:1,node:"td",item:function(e){e=t.create([l.year,l.month,e+(i.firstDay?1:0)]);var a=o&&o.pick==e.pick,m=s&&s.pick==e.pick,p=d&&t.disabled(e)||e.pick<c.pick||e.pick>u.pick;return[n.node("div",e.date,function(t){return t.push(l.month==e.month?i.klass.infocus:i.klass.outfocus),r.pick==e.pick&&t.push(i.klass.now),a&&t.push(i.klass.selected),m&&t.push(i.klass.highlighted),p&&t.push(i.klass.disabled),t.join(" ")}([i.klass.day]),"data-pick="+e.pick+" "+n.ariaAttr({role:"gridcell",selected:!(!a||t.$node.val()!==n.trigger(t.formats.toString,t,[i.format,e]))||null,activedescendant:!!m||null,disabled:!!p||null})),"",n.ariaAttr({role:"presentation"})]}})]}})),i.klass.table,'id="'+t.$node[0].id+'_table" '+n.ariaAttr({role:"grid",components:t.$node[0].id,readonly:!0}))+n.node("div",n.node("button",i.today,i.klass.buttonToday,"type=button data-pick="+r.pick+(e&&!t.disabled(r)?"":" disabled")+" "+n.ariaAttr({components:t.$node[0].id}))+n.node("button",i.clear,i.klass.buttonClear,"type=button data-clear=1"+(e?"":" disabled")+" "+n.ariaAttr({components:t.$node[0].id}))+n.node("button",i.close,i.klass.buttonClose,"type=button data-close=true "+(e?"":" disabled")+" "+n.ariaAttr({components:t.$node[0].id})),i.klass.footer)},i.defaults=function(e){return{labelMonthNext:"Next month",labelMonthPrev:"Previous month",labelMonthSelect:"Select a month",labelYearSelect:"Select a year",monthsFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdaysFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],today:"Today",clear:"Clear",close:"Close",format:"d mmmm, yyyy",klass:{table:e+"table",header:e+"header",navPrev:e+"nav--prev",navNext:e+"nav--next",navDisabled:e+"nav--disabled",month:e+"month",year:e+"year",selectMonth:e+"select--month",selectYear:e+"select--year",weekdays:e+"weekday",day:e+"day",disabled:e+"day--disabled",selected:e+"day--selected",highlighted:e+"day--highlighted",now:e+"day--today",infocus:e+"day--infocus",outfocus:e+"day--outfocus",footer:e+"footer",buttonClear:e+"button--clear",buttonToday:e+"button--today",buttonClose:e+"button--close"}}}(e.klasses().picker+"__"),e.extend("pickadate",i)}),define("../Runtime/source/syscomponents/filebox-utils",["jquery"],function(e){var t=window.Medline=window.Medline||{};t.Utils=t.Utils||{},t.WebSiteSearch=t.WebSiteSearch||{},t.WebSiteSearch.Resources=t.WebSiteSearch.Resources||{},t.WebSiteSearch.Models=t.WebSiteSearch.Models||{},t.WebSiteSearch.ViewModels=t.WebSiteSearch.ViewModels||{},t.Utils.guidSortingOrder=[],t.Utils.GetQueryString=function(e){var t=e.indexOf("?");return-1!=e?decodeURIComponent(e.substring(t+1).split("#").join("")):""},t.Utils.GetQueryStringParameter=function(e,i){for(var n=t.Utils.GetQueryString(i).split("&"),a=0;a<n.length;a+=1){var r=n[a].split("=");if(r[0].toLowerCase()==e.toLowerCase())return decodeURIComponent(r[1])}return""},t.Utils.GetReworkedAppWebUrl=function(e){return e=e.substring(e.indexOf("//")+2),e.substring(e.indexOf("/"))},t.Utils.DisplayErrorMessage=function(e){alert(e)},t.Utils.Log=function(e){},t.Utils.GetSearchResultField=function(e,t){return Enumerable.From(e.Cells.results).Where(function(e){return e.Key===t}).Select(function(e){return e.Value}).FirstOrDefault()},t.Utils.GetTaxonomyPropertyObject=function(e){var t={};try{for(var i=e.split(";"),n=0;n<i.length;n++){var a=i[n].split("|");"L0"==a[0]&&(t.displayName=a[2].split(":")[a[2].split(":").length-1],t.guid=a[1].split("#0")[1])}return t}catch(e){}},t.Utils.sortAndDisplayMenuItems=function(i,n,a,r){var o=[],s=[];e.map(i,function(e){-1!=n.indexOf(e.guid)?s.push(e):o.push(e)}),t.Utils.guidSortingOrder=n;var l=s.sort(t.Utils.customSort);l=l.concat(o),t.Utils.buildDepartmentNav(l,a,r)},t.Utils.buildDepartmentNav=function(t,i,n){for(var a="",r=0;r<i;r++)e.map(t,function(t){t.level==r+1&&0==r?a=a+"<li class='mainLevel' id='"+t.guid+"'><a href='#' termSetGuid='"+t.termSetGuid+"'>"+t.name+"</a></li>":t.level==r+1&&(e("ul","#"+t.parentGuid).length?e("ul","#"+t.parentGuid).append("<li id='"+t.guid+"'><a href='#' termSetGuid='"+t.termSetGuid+"'>"+t.name+"</a></li>"):e("#"+t.parentGuid).append("<ul><li id='"+t.guid+"'><a href='#' termSetGuid='"+t.termSetGuid+"'>"+t.name+"</a></li></ul>"))}),0==r&&e(n).append(a)},t.Utils.removeEmptyLinks=function(t,i){e.map(t,function(t){e("#"+t.navigation.guid).addClass("hasContent"),e("#"+t.navigation.guid+">a").attr("ListItemID",t.ListItemID).attr("ListID",t.ListID)}),e("li",i).each(function(t){e(this).hasClass("hasContent")||0!=e(".hasContent",this).length||e(this).remove()})},t.Utils.highlightDepartmentMenu=function(t,i){e("li",i).each(function(n){var a=e(this).find(">a").attr("listid"),r=e(this).find(">a").attr("listitemid");void 0!==a&&!1!==a&&void 0!==r&&!1!==r&&a==t.ListID&&r==t.ListItemID&&(e(this).addClass("active"),e(this).parentsUntil("li.mainLevel").addClass("active"),e("li.active",i).not(".mainLevel").find(">a").next().slideToggle())})},t.Utils.updateDepartmentLinks=function(i,n,a){e("a",i).each(function(i){var r=e(this).attr("href");if(void 0!==r&&!1!==r&&-1!=r.indexOf("www.contentlink.com/?id=")){r.split("?id=")[1];e(this).attr("href","#").attr("ListID",n).attr("ListItemID",r.split("?id=")[1]).attr("termSetGuid",a),e(this).addClass("linkToAnotherItem")}else void 0!==r&&!1!==r&&-1!=r.toLowerCase().indexOf("listid")&&-1!=r.toLowerCase().indexOf("listitemid")&&-1!=r.toLowerCase().indexOf("termsetguid")&&n==t.Utils.GetQueryStringParameter("ListID",r)&&-1!=r.toLowerCase().indexOf(_spPageContextInfo.serverRequestPath.toLocaleLowerCase())&&(e(this).attr("href","#").attr("ListID",t.Utils.GetQueryStringParameter("ListID",r)).attr("ListItemID",t.Utils.GetQueryStringParameter("ListItemID",r)).attr("termSetGuid",t.Utils.GetQueryStringParameter("termSetGuid",r)),e(this).addClass("linkToAnotherItem"))})},t.Utils.customSort=function(e,i){return-1!=t.Utils.guidSortingOrder.indexOf(e.guid)&&-1!=t.Utils.guidSortingOrder.indexOf(i.guid)&&t.Utils.guidSortingOrder.indexOf(e.guid)<t.Utils.guidSortingOrder.indexOf(i.guid)?-1:-1!=t.Utils.guidSortingOrder.indexOf(e.guid)&&-1!=t.Utils.guidSortingOrder.indexOf(i.guid)&&t.Utils.guidSortingOrder.indexOf(e.guid)>t.Utils.guidSortingOrder.indexOf(i.guid)?1:0}}),define("../Runtime/source/syscomponents/filebox-apppart",["jquery"],function(e){window.APPPART=function(e){function t(e){var t=RegExp("[?&]"+e+"=([^&]*)").exec(window.location.search);return t&&decodeURIComponent(t[1].replace(/\+/g," "))}function i(){if(0==r.isAppPart)return 0;if("windowHeight"==r.outerHeightControl){var t=window,i=document,n=i.documentElement,a=i.getElementsByTagName("body")[0],o=(t.innerWidth||n.clientWidth||a.clientWidth,t.innerHeight||n.clientHeight||a.clientHeight),s=document.getElementById("contentBox").getBoundingClientRect();contentHeight=o-s.top-50,e(".ms-srch-hover-viewerContainer").first().css({"min-height":contentHeight-75+"px"});var l=(document.getElementsByClassName("ms-srch-hover-viewerContainer"),"min-height:"+contentHeight-75+"px!important;");return l+="border-style:solid; border-color:green;",0}if("documentHeight"==r.outerHeightControl){if(e("div.productInformation").length){var d=document.getElementsByClassName("productInformation")[0],c=d.scrollHeight,o=window.innerHeight-120,u=o>c?o:c;return e(".ms-srch-hover-viewerContainer").first().css({"min-height":u+"px"}),c+120}var c=0,o=window.innerHeight-120,u=o>c?o:c;return e(".ms-srch-hover-viewerContainer").first().css({"min-height":u+"px"}),o+120}}function n(){if(1==r.isAppPart)return 0;if("windowHeight"==r.outerHeightControl){var t=window,i=document,n=i.documentElement,a=i.getElementsByTagName("body")[0],o=(t.innerWidth||n.clientWidth||a.clientWidth,t.innerHeight||n.clientHeight||a.clientHeight),s=document.getElementById("contentBox").getBoundingClientRect();contentHeight=o-s.top-50,e(".ms-srch-hover-viewerContainer").first().css({"min-height":contentHeight-75+"px"});var l=(document.getElementsByClassName("ms-srch-hover-viewerContainer"),"min-height:"+contentHeight-75+"px!important;");return l+="border-style:solid; border-color:green;",0}if("documentHeight"==r.outerHeightControl){if(e("div.productInformation").length){var d=document.getElementsByClassName("productInformation")[0],c=d.scrollHeight,o=window.innerHeight-120,u=o>c?o:c;return e(".ms-srch-hover-viewerContainer").first().css({"min-height":u+"px"}),c+120}var c=0,o=window.innerHeight-120,u=o>c?o:c;return e(".ms-srch-hover-viewerContainer").first().css({"min-height":u+"px"}),o+120}}function a(){return void setTimeout(function(){var t=document.getElementById("s4-workspace");e("#sfpClientView").css({left:"10px",right:"10px",position:"fixed"});var i=document.querySelector(".ms-srch-hover-innerContainer2"),n=i?i.querySelector("iframe"):null;n&&e(n).css({height:t.clientHeight-100+"px",width:"100%","padding-left":"1px","min-height":t.clientHeight-100+"px"})},100)}var r={},o=function(e){try{var t=e.data[0],i=e.data[1];"owaSetHeight"==t&&(r.owaDocumentHeight=parseInt(i,10),r.resize())}catch(e){return}};return void 0!==window.addEventListener?window.addEventListener("message",o,!1):void 0!==window.attachEvent&&window.attachEvent("onmessage",o),r.propertiesItemView=null,r.documentItemView=null,r.isAppPart=!0,r.owaDocumentHeight=0,r.expanded=!1,r.outerHeightControl="",r.innerHeightControl="",r.innerItemPropertiesElem=null,r.innerItemDocumentElem=null,r.getitemviewheight=function(){return 1==r.isAppPart?i():n()},r.setitemview=function(){void 0!==e&&(0==e("#sfpClientView").length&&(e("#DeltaPlaceHolderMain").before("<div id='sfpClientView' class='ms-srch-hover-outerContainer' style='display:none;' ></div>"),
e("#DeltaPlaceHolderMain").before("<div id='sfpClientView2' style='display:none;' ></div>"),r.owaDocumentHeight=0),e(document).ready(function(){APPPART.resize(),e(window).resize(function(e){APPPART.resize()})}))},r.resize=function(){a()},r.status=function(e,i,n){var a=parent.postMessage?parent:parent.document.postMessage?parent.document:void 0,r={message:"",senderId:t("SenderId")};return r.message="SP.UI.Status.AddStatus",r.title=e,r.html=i,r.color=n,r.atBeginning=!0,a.postMessage(JSON.stringify(r),document.referrer),!1},r.notification=function(e){var i=parent.postMessage?parent:parent.document.postMessage?parent.document:void 0,n={message:"",senderId:t("SenderId")};return n.message="SP.UI.Notify.AddNotification",n.title=e,n.isSticky=!1,i.postMessage(JSON.stringify(n),document.referrer),!1},r.expand=function(e){var i=parent.postMessage?parent:parent.document.postMessage?parent.document:void 0,n={message:"",senderId:t("SenderId")};return n.message="expand",n.heightcontrol=e,r.expanded=!0,r.outerHeightControl=e,i.postMessage(JSON.stringify(n),document.referrer),!1},r.collapse=function(){var e=parent.postMessage?parent:parent.document.postMessage?parent.document:void 0,i={message:"",senderId:t("SenderId")};return i.message="collapse",r.expanded=!1,e.postMessage(JSON.stringify(i),document.referrer),r.resize(),!1},r}(e)}),define("text!observable2.xml",[],function(){return'<div data-bind="visible: designmode, css: {\'ge-designmode\': designmode}">\r\n\t<span data-bind="text: internalName"></span><span>:</span><span data-bind="text: value" ></span>\r\n</div>\r\n'}),define("observable2",["text!observable2.xml"],function(e){function t(e){this.internalName=e?e.InternalName:"",this.designmode=e.parentContext().spaform.form.designMode,this.value=ko.observable().extend({namespace:e})}return t.prototype.schema={Params:{name:"",namespace:"listItem",promoted:!0,InternalName:""},Permalink:"https://spaforms365.com/docs/syslib-observable2/",Connections:{ListItem:["Any","Text","Choice","Note","Boolean","DateTime","Computed"]}},{viewModel:t,template:e}}),define("text!layout.xml",[],function(){return'<div class="ms-Grid"></div>\r\n'}),define("layout",["text!./layout.xml"],function(e){function t(e){}return function(){}.call(t.prototype),{viewModel:t,template:e}}),define("text!blank.xml",[],function(){return"<div data-bind=\"$init:{}, css: {'ge-designmode': designmode}\">\r\n</div>\r\n"}),define("blank",["text!blank.xml"],function(e){function t(e){this.designmode=e.parentContext().spaform.form.designMode}return function(){this.$init=function(e){}}.call(t.prototype),t.prototype.schema={Params:{},Permalink:"https://spaforms365.com/docs/syslib-blank/"},{viewModel:t,template:e}}),define("text!transition.xml",[],function(){return'<div class="ms-Table" data-bind="visible: visible, css: {\'ge-designmode\': designmode}">\r\n\t<div class="ms-Table-row">\r\n\t\t<span class="ms-Table-cell" style="float:left; width:80px;">\r\n\t\t\t<button type="button" data-bind="visible: show, click: click, css: valid" class="ms-Button ms-Button--primary"><span class="ms-Button-label" data-bind="text: title"></span></button>\r\n\t\t</span>\r\n\t</div>\r\n</div>\r\n'}),define("transition",["text!./transition.xml"],function(e){function t(e){var t=this;this.visible="function"==typeof e.visible?e.visible:ko.observable(e.visible);var i=e.parentContext().spaform,n=i.form,a="function"==typeof e.namespace?e.namespace():e.namespace,r=e.InternalName,o="function"==typeof e.from?e.from():e.from,s="function"==typeof e.to?e.to():e.to,l="*"==s,d=JSON.parse(JSON.stringify(e));delete d.$raw;var c=i.runtime;this.readonly=c.dataContext(a).readonly,this.designmode=c.designMode,this.title=ko.observable(e.Title),i.form.closeOnClick=e.closeonclick;var u=function(e){return!0},m=function(e){},p=function(e){return e};n.workflow.fsm.append({name:r,fromId:o,toId:l?function(e){return p(e)}:s,info:{id:r,label:this.title(),component:"transition",stateComponentId:e.stateComponentId,params:d},onBeforeClick:u,onAfterClick:m}),this.fix=ko.observable(0),setInterval(function(){t.fix(Date.now())},500),this.valid=ko.computed(function(){if(i.runtime&&"function"==typeof i.runtime.dataContext){return!!t.fix()&&i.runtime.dataContext(a).vGroup.isValid()?"":"is-disabled"}return"is-disabled"},this),this.click=function(){n.workflow.fsm[n.workflow.fsm.camelize(r)](n.state())},this.show=ko.computed(function(){var e=n.state()==o||"*"==o,i=!!t.fix();return!!n.workflow.fsm&&(i&&e&&!this.readonly()&&n.workflow.fsm.can(r))},this),window.setTimeout(function(){RefreshCommandUI()},100)}return t.prototype.schema={Params:{namespace:"listItem",visible:!0,Title:"transition",from:"New Form",to:"New Form",closeonclick:!1,emailNotification:!1,logHistory:""},Permalink:"https://spaforms365.com/docs/syslib-transition/"},{viewModel:t,template:e}}),define("text!state.xml",[],function(){return'<div class="ms-Grid" params="\'namespace\':\'state\'" style="border:5px; border-color:#0078d7; border-style:solid; padding:5px; padding-top:0px;">\r\n    <div class="ms-Grid-row">\r\n        <div class="ms-u-md12 ms-u-sm12 ms-Grid-col ms-u-lg12" style="background-color:#0078d7; color:white; padding-bottom: 5px;">\r\n\t\t\t<b>\r\n\t\t\t\t<div><span  data-bind="text: stName"></span></div>\r\n\t\t\t</b>\r\n        </div>\r\n    </div>\r\n    <div class="ms-Grid-row">\r\n        <div class="ms-u-lg12 ms-u-md12 ms-u-sm12 ms-Grid-col">\r\n            <p>Lorem ipsum dolores</p>\r\n        </div>\r\n    </div>\r\n    <div class="ms-Grid-row">\r\n        <div class="ms-u-lg12 ms-u-md12 ms-u-sm12 ms-Grid-col">\r\n        </div>\r\n    </div>\r\n</div>\r\n'}),define("state",["text!./state.xml"],function(e){function t(e){var t=this,i=e.parentContext().spaform;t.params=e,this.stName=ko.computed(function(){var e=i.form.state();return i.form.stateObject(e).label})}return t.prototype.schema={Params:{name:"state",namespace:"state",promoted:!1},Permalink:"https://spaforms365.com/docs/syslib-state/",ListColumns:{mwp_FormState:'<Field ID="{2223b379-4a56-25b5-bc14-8f3c5360e526}" Type="Text" Name="mwp_FormState" Required="FALSE" DisplayName="Form State" Description="Form State" Group="Medline Web Portal" SourceID="{cbfbae2b-8362-4201-ac65-6a64a7d1d411}" StaticName="mwp_FormState" AllowDeletion="TRUE" Version="1" Customization="" ColName="nvarchar5" RowOrdinal="0"><Default>Draft</Default></Field>'}},{viewModel:t,template:e}}),define("text!textbox.xml",[],function(){return'<div data-bind="$init:{}, css: {\'ge-designmode\': designmode}">\r\n\t<label class="ms-Label" data-bind="text: title, visible: showTitle, css: enableRequired"></label>\r\n\t<div class="ms-TextField ms-TextField--placeholder" >\r\n\t\t<label class="ms-Label" style="display: none;" data-bind="text: description, style: {display: enableDescription()}"></label>\r\n\t\t<input class="ms-TextField-field is-formfield" style="z-index:0" type="text" data-bind="textInput: value, enable: enableValue, enterkey: {}" />\r\n\t</div>\r\n</div>\r\n'}),define("textbox",["text!textbox.xml"],function(e){function t(e){this.params=e,this.internalName=e?e.InternalName:"";var t=e.parentContext().spaform,i=t.runtime;this.readonly=i.dataContext(e.namespace).readonly,this.designmode=i.designMode,this.title=ko.observable(e?e.Title:""),this.description=ko.observable(e?e.Description:""),this.required=ko.observable(!!e&&(!!e.Required&&e.Required)),this.readonlyfield=ko.observable(!!e&&(!!e.ReadOnlyField&&e.ReadOnlyField)),this.maxlength=ko.observable(e&&e.MaxLength?e.MaxLength:100),this.defaultvalue=ko.observable(e&&e.DefaultValue?e.DefaultValue:""),this.value=ko.observable(e.DefaultValue).extend({namespace:e}),this.value.extend({required:this.required()}).extend({maxLength:this.maxlength()}),this.enableValue=ko.pureComputed(function(){return this.$enabled()},this),this.enableDescription=ko.pureComputed(function(){return this.value()&&0===this.value().length?"block":"none"},this),this.enableRequired=ko.pureComputed(function(){return this.required()?"is-required":""},this),this.showTitle=ko.pureComputed(function(){return!!(this.title()&&this.title().length>0)},this)}return function(){this.$enabled=function(){return!this.readonly()&&!this.readonlyfield()},this.$init=function(e){for(var t=e.querySelectorAll(".ms-TextField"),i=0;i<t.length;i++)this.fabricObject=new fabric.TextField(t[i])}}.call(t.prototype),t.prototype.schema={Params:{name:"",namespace:"listItem",promoted:!0,InternalName:"",Title:"",Description:"",MaxLength:100,DefaultValue:"",FieldTypeKind:2,ReadOnlyField:!1,Required:!1},Connections:{ListItem:["Text"],PromotedColumnXml:'<Field Type="Text"  Name="#params.InternalName#" Required="#params.Required#"  DisplayName="#params.Title#" Description="#params.Description#" Group="SPA FORMS 365" MaxLength="#params.MaxLength#"  StaticName="#params.InternalName#" AllowDeletion="TRUE"><Default>#params.DefaultValue#</Default></Field>'},Permalink:"https://spaforms365.com/docs/syslib-textbox/"},{viewModel:t,template:e}}),define("text!checkbox.xml",[],function(){return'<div data-bind="$init: {}, css: {\'ge-designmode\': designmode}">\r\n\t<div class="ms-ChoiceFieldGroup-title">\r\n\t\t<label class="ms-Label" data-bind="text: title, visible: showTitle, css: enableRequired"></label>\r\n\t</div>\r\n\t<div class="validationBox">\r\n\t\t<div class="ms-CheckBox">\r\n\t\t\t<input tabindex="-1" type="checkbox" class="ms-CheckBox-input"/>\r\n\t\t\t<label role="checkbox" class="ms-CheckBox-field is-formfield" tabindex="0" data-bind="click: onclick, enterkey: {}, css: { \'is-checked\': value(), \'is-disabled\': $readonly()}"></label>\r\n\t\t\t<span class="ms-TextField-description" data-bind="text: description" style="margin-left:25px;"></span>\r\n\t\t</div>\t\t\t\t\t\t\t\r\n\t</div>\r\n\t<div>\r\n\t\t\r\n\t</div>\r\n</div>\r\n'}),define("checkbox",["text!checkbox.xml"],function(e){function t(e){var t=this;this.internalName=e?e.InternalName:"";var i=e.parentContext().spaform,n=i.runtime;this.readonly=n.dataContext(e.namespace).readonly,this.designmode=n.designMode,this.$readonly=ko.pureComputed(function(){return this.readonly()},this),this.title=ko.observable(e?e.Title:""),this.description=ko.observable(e?e.Description:""),this.required=ko.observable(!!e&&(!!e.Required&&e.Required)),this.value=ko.observable(e.DefaultValue).extend({namespace:e}),this.value.extend({required:this.required()}),this.enabled=ko.pureComputed(function(){return this.$enabled()},this),this.enableValue=ko.pureComputed(function(){return this.$enabled()?"":"is-disabled"},this),this.enableRequired=ko.pureComputed(function(){return this.required()?"is-required":""},this),this.onclick=function(e,i){if(!i.currentTarget.classList.contains("is-disabled")){var n=!i.currentTarget.classList.contains("is-checked");t.value(n)}},this.showTitle=ko.pureComputed(function(){return!!(this.title()&&this.title().length>0)},this)}return function(){this.$enabled=function(){return this.readonly()?"is-disabled":""},this.$init=function(e){for(var t=e.querySelectorAll(".validationBox"),i=0;i<t.length;i++)if(this.fabricObject={},this.fabricObject.validationBox=t[i],ko.validation){var n=ko.validation.insertValidationMessage(this.fabricObject.validationBox);ko.applyBindingsToNode(n,{validationMessage:this.value}),ko.applyBindingsToNode(this.fabricObject.validationBox,{validationElement:this.value})}}}.call(t.prototype),t.prototype.schema={Params:{name:"",namespace:"listItem",promoted:!0,InternalName:"",Title:"",DefaultValue:void 0,ReadOnlyField:!1,Required:!1,FieldTypeKind:8,Description:"Check Box"},Permalink:"https://spaforms365.com/docs/syslib-checkbox/",Connections:{ListItem:["Boolean"],PromotedColumnXml:'<Field Type="Boolean"  Name="#params.InternalName#" Required="#params.Required#"  DisplayName="#params.Title#" Description="#params.Description#" Group="SPA FORMS 365" StaticName="#params.InternalName#" AllowDeletion="TRUE"></Field>'}},{viewModel:t,template:e}}),define("text!messagebox.xml",[],function(){return'<div class="ms-Table" data-bind="initmessagebox: {}, visible: enabled, css: {\'ge-designmode\': designmode}" >\r\n\t<div class="ms-Table-row" style="background-color:#0078d7;" >\r\n\t\t<span class="ms-Table-cell ms-Button-label" style="float:left; border-width:3px; border-style:solid; background-color:#0078d7; border-color:#0078d7; color:white;" data-bind="text: messageText"></span>\r\n\t\t<button data-bind="click: _formButtonCloseMessageClick" style="float:right;" class="ms-Button ms-Button--primary"><span class="ms-Button-label">Close Message</span></button>\r\n\t</div>\r\n</div>\r\n'}),define("messagebox",["text!messagebox.xml"],function(e){function t(e){var t=this;t.form=ko.observable(),t.params=e,t.spaform=e.parentContext().spaform,this.designmode=t.spaform.runtime.designMode,t._formButtonCloseMessageClick=function(){t.spaform.runtime._formStatusMessageEnabled(!1)},t.enabled=ko.pureComputed(function(){return t.spaform.runtime._formStatusMessageEnabled()||t.spaform.form.designMode()}),t.designing=ko.pureComputed(function(){return t.spaform.runtime.designMode()}),t.messageText=ko.pureComputed(function(){return t.spaform.runtime._formStatusMessageText()}),t.Init=function(e){t.form()._formStatusMessageText=ko.observable(e.message),t.form()._formStatusMessageEnabled=ko.observable(!1),t.form()._formStatusMessageAllowed=ko.observable(""!=e.message),t.form()._formStatusMessage=function(e){this._formStatusMessageAllowed()&&this._formStatusMessageEnabled(!0)}}}return t.prototype.schema={Params:{message:"COMPLETED SUCCESSFULLY. MY FORMS VIEW WILL REFLECT CHANGES WITH 5 MIN DELAY"},Permalink:"https://spaforms365.com/docs/syslib-messagebox/"},ko.bindingHandlers.initmessagebox={init:function(e,t,i,n,a){n.form(a.$root),n.Init(n.params)}},{viewModel:t,template:e}}),define("text!dropdown.xml",[],function(){return'<div data-bind="$init: {}, css: {\'ge-designmode\': designmode}">\r\n\t<label class="ms-Label" data-bind="text: title, visible: showTitle, css: enableRequired"></label>\r\n\t<div class="ms-Dropdown is-formfield" tabindex="0" data-bind="css: enableValue, enterkey: {}">\r\n\t\t<i class="ms-Dropdown-caretDown ms-Icon ms-Icon--ChevronDown"></i>\r\n\t\t<select class="ms-Dropdown-select" data-bind=" optionsCaption: description, options: choices"></select>\r\n\t</div>\r\n</div>\r\n'}),define("dropdown",["text!dropdown.xml"],function(e){function t(e){var t=e.parentContext().spaform,i=t.runtime;this.readonly=i.dataContext(e.namespace).readonly,this.designmode=i.designMode,this.internalName=e?e.InternalName:"",this.availablechoices=e?e.Choices:[],this.title=ko.observable(e?e.Title:""),this.choices=ko.observableArray(this.availablechoices),this.description=ko.observable(e&&e.Description&&e.Description.length>0?e.Description:"Select..."),this.required=ko.observable(!!e&&(!!e.Required&&e.Required)),this.readonlyfield=ko.observable(!!e&&(!!e.ReadOnlyField&&e.ReadOnlyField)),this.defaultvalue=ko.observable(e&&e.DefaultValue?e.DefaultValue:""),this.value=ko.observable().extend({namespace:e}),ko.validation&&this.value.extend({required:this.required()}),this.enableValue=ko.pureComputed(function(){return this.$enabled()?"":"is-disabled"},this),this.enableRequired=ko.pureComputed(function(){return this.required()?"is-required":""},this),this.showTitle=ko.pureComputed(function(){return!!(this.title()&&this.title().length>0)},this)}return fabric.Dropdown.prototype._checkTruncation=function(){var e=this._container.getAttribute("fulltitle");if(this._dropdownLabelHelper.textContent=e,this._dropdownLabelHelper.offsetHeight>this._newDropdownLabel.offsetHeight){var t=0,i=void 0;do{t--,i=e.slice(0,t),this._dropdownLabelHelper.textContent=i+"..."}while(this._dropdownLabelHelper.offsetHeight>this._newDropdownLabel.offsetHeight)}this._newDropdownLabel.textContent=this._dropdownLabelHelper.textContent},function(){this.$enabled=function(){return!this.readonly()&&!this.readonlyfield()},this.$init=function(e){var t=this;setTimeout(function(){var i=e.querySelector(".ms-Dropdown");if(t.fabricObject=new fabric.Dropdown(i),t.fabricObject._dropdownIcon=t.fabricObject._container.querySelector(".ms-Dropdown-caretDown"),t.fabricObject._newDropdownLabel.innerHTML=t.value()?t.value():"",t.fabricObject._container.setAttribute("fulltitle",t.value()?t.value():t.description()),t.fabricObject._checkTruncation(),t.fabricObject._originalDropdown.addEventListener("change",function(e){for(var i=0,n=0;n<t.fabricObject._dropdownItems.length;++n)t.fabricObject._dropdownItems[n].oldOption.selected&&(i=n);t.value(0==i?void 0:t.choices()[i-1]),t.fabricObject._container.setAttribute("fulltitle",t.value()?t.value():t.description()),t.fabricObject._checkTruncation()},!1),ko.validation){var n=ko.validation.insertValidationMessage(t.fabricObject._newDropdownLabel);ko.applyBindingsToNode(n,{validationMessage:t.value}),ko.applyBindingsToNode(t.fabricObject._newDropdownLabel,{validationElement:t.value}),ko.applyBindingsToNode(t.fabricObject._dropdownIcon,{validationElement:t.value})}},300)}}.call(t.prototype),t.prototype.schema={Params:{name:"",namespace:"listItem",promoted:!0,InternalName:"",Title:"",Description:"",DefaultValue:void 0,FieldTypeKind:6,ReadOnlyField:!1,Required:!1,Choices:["Option 1","Option 2"]},Permalink:"https://spaforms365.com/docs/syslib-dropdown/",Connections:{ListItem:["Choice"],PromotedColumnXml:'<Field Type="Choice" Format="Dropdown" Name="#params.InternalName#" Required="#params.Required#"  DisplayName="#params.Title#" Description="#params.Description#" Group="SPA FORMS 365"  StaticName="#params.InternalName#" AllowDeletion="TRUE"></Field>'}},{viewModel:t,template:e}}),define("text!checkboxgroup.xml",[],function(){return'<div data-bind="$init: {}, css: {\'ge-designmode\': designmode}">\r\n\t<div class="ms-ChoiceFieldGroup-title">\r\n\t\t<label class="ms-Label" data-bind="text: title, visible: showTitle, css: enableRequired"></label>\r\n\t</div>\r\n\t<div class="validationBox">\r\n\t\t<div data-bind="foreach: {data: choices, as: \'choice\'}">\r\n\t\t\t<div class="ms-CheckBox">\r\n\t\t\t\t<input tabindex="-1" type="checkbox" class="ms-CheckBox-input"/>\r\n\t\t\t\t<label role="checkbox" class="ms-CheckBox-field is-formfield" tabindex="0" data-bind="click: choice.onclick, enterkey: {}, css: { \'is-checked\': choice.checked(), \'is-disabled\': $parent.$readonly()}">\r\n\t\t\t\t\t<span class="ms-Label" data-bind="text: choice.key"></span>\r\n\t\t\t\t</label>\r\n\t\t\t</div>\t\t\t\t\t\t\t\r\n\t\t</div>\r\n\t</div>\r\n\t<div>\r\n\t\t<span class="ms-TextField-description" data-bind="text: description"></span>\r\n\t</div>\r\n</div>\r\n'}),define("checkboxgroup",["text!checkboxgroup.xml"],function(e){function t(e){var t=e.parentContext().spaform,i=t.runtime;this.readonly=i.dataContext(e.namespace).readonly,this.designmode=i.designMode,this.$readonly=ko.pureComputed(function(){return this.readonly()},this),this.internalName=e?e.InternalName:"",this.availablechoices=e?e.Choices:[],this.choices=ko.observableArray(this.$choices(this.availablechoices)),this.title=ko.observable(e?e.Title:""),this.description=ko.observable(e?e.Description:""),this.required=ko.observable(!!e&&(!!e.Required&&e.Required)),this.readonlyfield=ko.observable(!!e&&(!!e.ReadOnlyField&&e.ReadOnlyField)),this.defaultvalue=ko.observable(e&&e.DefaultValue?e.DefaultValue:""),this.defaultmessage=ko.observable(e&&e.DefaultMessage?e.DefaultMessage:""),this.value=ko.observable().extend({namespace:e}),ko.validation&&this.value.extend({required:this.required()}),this.value.subscribe(function(e){this.required()||e&&""!=e||(e={},e.results=[],this.value(e));var t=e?e.results:[];this.choices(this.$choices(this.availablechoices,t))},this),this.enableRequired=ko.pureComputed(function(){return this.required()?"is-required":""},this),this.showTitle=ko.pureComputed(function(){return!!(this.title()&&this.title().length>0)},this)}return function(){this.$init=function(e){for(var t=e.querySelectorAll(".validationBox"),i=0;i<t.length;i++)if(this.fabricObject={},this.fabricObject.validationBox=t[i],ko.validation){var n=ko.validation.insertValidationMessage(this.fabricObject.validationBox);ko.applyBindingsToNode(n,{validationMessage:this.value}),ko.applyBindingsToNode(this.fabricObject.validationBox,{validationElement:this.value})}},this.$update=function(e,t){var i=this.value();t?(i&&""!=i||(i={},this.value(i)),i.results||(i.results=[]),i.results.push(e)):(i.results.splice(i.results.indexOf(e),1),this.required()&&0==i.results.length&&(i=void 0)),this.value(i)},this.$choices=function(e,t){var i=[];return e.forEach(function(e,t){i.push({key:e,parent:this,checked:ko.observable(""),onclick:function(e,t){t.currentTarget.classList.contains("is-disabled")||(this.checked(!t.currentTarget.classList.contains("is-checked")),this.parent.$update(this.key,!t.currentTarget.classList.contains("is-checked")))}})},this),t&&t.forEach(function(e,t){var n=$.grep(i,function(t){return t.key==e});1==n.length&&n[0].checked(!0)},this),i}}.call(t.prototype),t.prototype.schema={Params:{name:"",namespace:"listItem",promoted:!0,InternalName:"",Title:"",Description:"",ReadOnlyField:!1,Required:!1,FieldTypeKind:15,DefaultValue:void 0,Choices:["Choice 1","Choice 2"]},Permalink:"https://spaforms365.com/docs/syslib-checkboxgroup/",Connections:{ListItem:["MultiChoice"],PromotedColumnXml:'<Field Type="MultiChoice" Name="#params.InternalName#" Required="#params.Required#"  DisplayName="#params.Title#" Description="#params.Description#" Group="SPA FORMS 365"  StaticName="#params.InternalName#" AllowDeletion="TRUE"></Field>'}},{viewModel:t,template:e}}),define("text!radiogroup.xml",[],function(){return'<div data-bind="$init: {}, css: {\'ge-designmode\': designmode}">\r\n\t<div class="ms-ChoiceFieldGroup" role="radiogroup" data-bind="css: enableValue">\r\n\t\t<div class="ms-ChoiceFieldGroup-title">\r\n\t\t\t<label class="ms-Label" data-bind="text: title, visible: showTitle, css: enableRequired"></label>\r\n\t\t</div>\r\n\t\t<div class="validationBox">\r\n\t\t\t<div data-bind="foreach: {data: choices, as: \'choice\'}">\r\n\t\t\t\t<div class="ms-RadioButton">\r\n\t\t\t\t\t<input tabindex="-1" type="radio" class="ms-RadioButton-input"/>\r\n\t\t\t\t\t<label role="radio" class="ms-RadioButton-field is-formfield" tabindex="0" data-bind="click: choice.onclick, enterkey: {}, css: { \'is-checked\': choice.checked(), \'is-disabled\': $parent.$readonly()}">\r\n\t\t\t\t\t\t<span class="ms-Label" data-bind="text: choice.key"></span>\r\n\t\t\t\t\t</label>\r\n\t\t\t\t</div>\t\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\t<div>\r\n\t\t<span class="ms-TextField-description" data-bind="text: description"></span>\r\n\t</div>\r\n</div>\r\n'}),define("radiogroup",["text!radiogroup.xml"],function(e){function t(e){var t=e.parentContext().spaform,i=t.runtime;this.readonly=i.dataContext(e.namespace).readonly,this.designmode=i.designMode,this.$readonly=ko.pureComputed(function(){return this.readonly()},this),this.internalName=e?e.InternalName:"",this.availablechoices=e?e.Choices:[],this.choices=ko.observableArray(this.$choices(this.availablechoices)),this.title=ko.observable(e?e.Title:""),this.description=ko.observable(e?e.Description:""),this.required=ko.observable(!!e&&(!!e.Required&&e.Required)),this.readonlyfield=ko.observable(!!e&&(!!e.ReadOnlyField&&e.ReadOnlyField)),this.defaultvalue=ko.observable(e&&e.DefaultValue?e.DefaultValue:""),this.defaultmessage=ko.observable(e&&e.DefaultMessage?e.DefaultMessage:""),this.value=ko.observable().extend({namespace:e}),ko.validation&&this.value.extend({required:this.required()}),this.value.subscribe(function(e){this.choices(this.$choices(this.availablechoices,e))},this),this.enableValue=ko.pureComputed(function(){return this.$enabled()?"":"is-disabled"},this),this.enableRequired=ko.pureComputed(function(){return this.required()?"is-required":""},this),this.defaultvalue()&&this.choices(this.$choices(this.availablechoices,this.value())),this.showTitle=ko.pureComputed(function(){return!!(this.title()&&this.title().length>0)},this)}return function(){this.$enabled=function(){return!this.readonly()&&!this.readonlyfield()},this.$init=function(e){for(var t=e.querySelectorAll(".validationBox"),i=0;i<t.length;i++)if(this.fabricObject={},this.fabricObject.validationBox=t[i],ko.validation){var n=ko.validation.insertValidationMessage(this.fabricObject.validationBox);ko.applyBindingsToNode(n,{validationMessage:this.value}),ko.applyBindingsToNode(this.fabricObject.validationBox,{validationElement:this.value})}},this.$select=function(e){this.choices().forEach(function(t,i){t.checked(t.key==e)}),this.value(e)},this.$choices=function(e,t){var i=[];if(e.forEach(function(e,t){i.push({key:e,parent:this,checked:ko.observable(""),onclick:function(e,t){t.currentTarget.classList.contains("is-disabled")||0==t.currentTarget.classList.contains("is-checked")&&this.parent.$select(this.key)}})},this),t){var n=$.grep(i,function(e){return e.key==t});1==n.length&&n[0].checked(!0)}return i}}.call(t.prototype),t.prototype.schema={Params:{name:"",namespace:"listItem",promoted:!0,InternalName:"",Title:"",Description:"",ReadOnlyField:!1,Required:!1,FieldTypeKind:6,DefaultValue:void 0,Choices:["Option 1","Option 2"]},Permalink:"https://spaforms365.com/docs/syslib-radiogroup/",Connections:{ListItem:["Choice"],PromotedColumnXml:'<Field Type="Choice" Format="RadioButtons" Name="#params.InternalName#" Required="#params.Required#"  DisplayName="#params.Title#" Description="#params.Description#" Group="SPA FORMS 365"  StaticName="#params.InternalName#" AllowDeletion="TRUE"></Field>'}},{viewModel:t,template:e}}),define("text!personabox.xml",[],function(){return'<div data-bind="$init: {}, css: {\'ge-designmode\': designmode}">\r\n\t<label class="ms-Label" data-bind="text: title, visible: showTitle, css: enableRequired"></label>\r\n    <div class="ms-PeoplePicker ms-PeoplePicker--compact">\r\n        <div class="ms-PeoplePicker-searchBox" data-bind="css: enableValue">\r\n            <div class="ms-TextField  ms-TextField--textFieldUnderlined " data-bind="visible: showValue">\r\n                <input class="ms-TextField-field is-formfield" type="text" data-bind="textInput: query, hasFocus: onfocus, attr: {placeholder: description}, enterkey: {}" value=""/>\r\n            </div>\r\n        </div>\r\n        <div class="ms-PeoplePicker-results ms-PeoplePicker-results--compact " >\r\n\t\t\t<div class="ms-PeoplePicker-resultGroup" data-bind="foreach: {data: results, as: \'persona\'}">\r\n                <div class="ms-PeoplePicker-result " tabindex="1">\r\n                    <div class="ms-Persona ms-Persona--xs" data-bind="click: persona.onselect">\r\n                        <div class="ms-Persona-imageArea">\r\n                            <div class="ms-Persona-initials ms-Persona-initials--blue" data-bind="text: persona.Initials, css: persona.Color"></div>\r\n                        </div>\r\n                        <div class="ms-Persona-presence">\r\n                        </div>\r\n                        <div class="ms-Persona-details">\r\n                            <div class="ms-Persona-primaryText" data-bind="text: persona.PrimaryText"></div>\r\n                            <div class="ms-Persona-secondaryText" data-bind="text: persona.SecondaryText"></div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\t\t\t</div>\r\n        </div>\r\n    </div>\t\t\r\n</div>\r\n'}),define("personabox",["text!personabox.xml"],function(e){function t(e){this.internalName=e?e.InternalName:"";var t=e.parentContext().spaform,i=t.runtime;this.runtime=ko.observable(i),this.readonly=i.dataContext(e.namespace).readonly,this.designmode=i.designMode,this.title=ko.observable(e?e.Title:""),this.description=ko.observable(e&&e.Description&&e.Description.length>0?e.Description:"type new user name..."),this.required=ko.observable(!!e&&(!!e.Required&&e.Required)),this.readonlyfield=ko.observable(!!e&&(!!e.ReadOnlyField&&e.ReadOnlyField)),this.defaultvalue=ko.observable(e&&e.DefaultValue?e.DefaultValue:""),this.color=ko.observable(e&&e.Color?e.Color:"ms-Persona-initials--green"),this.allowmultiplevalues=ko.observable(!(!e||!e.AllowMultipleValues)&&e.AllowMultipleValues),this.results=ko.observableArray([]),this.value=ko.observable({results:[]}).extend({namespace:e}),this.appendvalue=!1,this.appendvalue=!1,ko.validation&&this.value.extend({required:this.required()}),this.enableValue=ko.pureComputed(function(){return this.$enabled()?"":"is-disabled"},this),this.showValue=ko.pureComputed(function(){return this.$enabled()},this),this.enableRequired=ko.pureComputed(function(){return this.required()?"is-required":""},this),this.showTitle=ko.pureComputed(function(){return!!(this.title()&&this.title().length>0)},this),this.query=ko.observable(""),this.onfocus=ko.observable(!1),this.querycache=ko.observable(""),this.onfocus.subscribe(function(e){var t=this;e||setTimeout(function(){t.fabricObject._contextualHostView&&(t.fabricObject._contextualHostView._container.parentNode&&t.fabricObject._contextualHostView.disposeModal(),t.fabricObject._contextualHostView=void 0)},500)},this),this.options={minQueryLength:1,maxResultsetLength:5},this.query.subscribe(function(e){this.onfocus()&&this.querycache(e);var t=this;e.length<=this.options.minQueryLength?(this.results(this.$results([])),$(".ms-ContextualHost-main").hide()):this.runtime()._formPeopleQuery(e).done(function(e){0==e.length?$(".ms-ContextualHost-main").hide():$(".ms-ContextualHost-main").show();var i=t.$results(e);t.results(i)})},this)}return fabric.PeoplePicker.prototype._loadField=function(){this._peoplePickerResults=this._peoplePickerMenu.querySelectorAll(".ms-PeoplePicker-result");for(var e=0;e<this._peoplePickerResults.length;e++){var t=this._peoplePickerResults[e].querySelector(".ms-Persona"),i=t,n=i.cloneNode(!0);this._container.classList.contains("ms-PeoplePicker--facePile")?this._addResultToMembers(n):this._tokenizeResult(n),this._updateCount()}},fabric.PeoplePicker.prototype._clickHandler=function(e){this._peoplePickerResults=this._peoplePickerMenu.querySelectorAll(".ms-PeoplePicker-result"),this._peoplePickerResults.length>0&&this._createModalHost(e)},fabric.PeoplePicker.prototype._removeToken=function(e){var t=this._findElement(e.target,"ms-Persona"),i=t.querySelector(".ms-Persona-primaryText");this._removeCallback&&this._removeCallback(i.innerText),t.remove()},fabric.PeoplePicker.prototype._removeFirstToken=function(){var e=this._container.querySelector(".ms-PeoplePicker-searchBox"),t=e.querySelector(".ms-Persona");if(t){t.querySelector(".ms-Persona-primaryText");t.remove()}},fabric.PeoplePicker.prototype._addRemoveBtn=function(e,t){var i,n=document.createElement("i");t?(i=document.createElement("div"),i.classList.add("ms-Persona-actionIcon"),i.addEventListener("click",this._removeToken.bind(this),!0)):(i=document.createElement("button"),i.classList.add("ms-PeoplePicker-resultAction"),i.addEventListener("click",this._removeResult.bind(this),!0)),n.classList.add("ms-Icon","ms-Icon--Cancel"),i.appendChild(n),e.appendChild(i),this._isReadOnly(i)},fabric.PeoplePicker.prototype._selectResult=function(e){e.stopPropagation();var t=this._findElement(e.target,"ms-Persona"),i=t.cloneNode(!0);this._container.classList.contains("ms-PeoplePicker--facePile")?this._addResultToMembers(i):this._tokenizeResult(i),this._updateCount(),this._contextualHostView&&this._contextualHostView.disposeModal(),this._contextualHostView=void 0,this._selectedResult=!0,this._container.querySelector(".ms-TextField-field").value=""},fabric.PeoplePicker.prototype._contextHostCallBack=function(){this._peoplePickerSearchBox.classList.remove("is-active"),this._isContextualMenuOpen=!1},function(){this.$enabled=function(){return!this.readonly()&&!this.readonlyfield()},this.$processValue=function(e,t){var i=this,n=function(){for(var e=i.fabricObject._peoplePickerMenu.querySelector(".ms-PeoplePicker-resultGroup");e.firstChild;)e.removeChild(e.firstChild)};if(e||(e={}),
e.intname&&e.intname!=params.InternalName)return void(i.appendvalue=!1);if(e.__metadata&&"SP.Data.UserInfoItem"==e.__metadata.type?(e.results=-1==e.Id?[]:[{Title:e.Title,Id:e.Id}],delete e.__metadata,delete e.Title,delete e.Id):e.__metadata&&"Collection(Edm.Int32)"==e.__metadata.type||e&&!e.results&&(e.results=[]),!i.appendvalue)if(t)i.fabricObject._loadField();else{i.query(""),n();var a=i.$fieldresults(e.results);i.results(a),setTimeout(function(){i.fabricObject._loadField(),i.results([]),n()},100)}i.appendvalue=!1},this.$init=function(e){var t=e.querySelector(".ms-PeoplePicker"),i=this;if(this.fabricObject=new fabric.PeoplePicker(t),this.fabricObject._isReadOnly=function(e){ko.applyBindingsToNode(e,{visible:i.showValue})},this.fabricObject._removeCallback=function(e){var t=i.value(),n=-1;t.results.forEach(function(t,i){t.Title==e&&(n=i)}),n>=0&&t.results.splice(n,1),i.appendvalue=!0,i.value(t)},ko.validation){var n=ko.validation.insertValidationMessage(this.fabricObject._container);ko.applyBindingsToNode(n,{validationMessage:this.value}),ko.applyBindingsToNode(this.fabricObject._container,{validationElement:this.value})}var a=this.value();this.$processValue(a,!1),this.value.subscribe(function(e){this.$processValue(e,!1)},this)},this.$initials=function(e){var t=e.split(",");return(t[1]?t[1].trim().charAt(0):"?")+(t[0]?t[0].trim().charAt(0):"?")},this.$results=function(e){var t=this,i=[];return e.forEach(function(e,n){i.push({Color:this.color(),Initials:this.$initials(e.DisplayText),PrimaryText:e.DisplayText,SecondaryText:e.EntityData.Department,parent:this,jsonObject:e,onselect:function(e,i){var n=this.jsonObject.Key;this.parent.runtime()._formPeopleQuery({userName:n}).done(function(e){var a=t.value();t.allowmultiplevalues()||(a.results=[]),a.results.push({__metadata:{Id:"",type:"SP.Data.UserInfoItem"},Title:e.Title,Id:e.Id,Key:n}),t.allowmultiplevalues()||t.fabricObject._removeFirstToken(),t.fabricObject._selectResult(i),t.appendvalue=!0,t.value(a)})}})},this),i},this.$fieldresults=function(e){var t=this,i=[];return e.forEach(function(e,n){i.push({Color:this.color(),Initials:this.$initials(e.Title),PrimaryText:e.Title,SecondaryText:e.Id,jsonObject:e,onselect:function(e,i){t.fabricObject._selectResult(i)}})},this),i}}.call(t.prototype),t.prototype.schema={Params:{name:"",namespace:"listItem",promoted:!0,InternalName:"",Title:"",AllowMultipleValues:!0,Description:"",DefaultValue:!1,LookupField:!1,LookupList:!1,LookupWebId:!1,Presence:!1,SelectionGroup:0,SelectionMode:1,ReadOnlyField:!1,FieldTypeKind:20,Color:"ms-Persona-initials--green",ReadOnlyField:!1,Required:!1},Permalink:"https://spaforms365.com/docs/syslib-personabox/",Connections:{ListItem:["UserMulti","User"],PromotedColumnXml:'<Field Type="UserMulti" List="UserInfo" ShowField="ImnName"  UserSelectionMode="PeopleAndGroups" UserSelectionScope="0" Mult="#params.AllowMultipleValues#" Name="#params.InternalName#" Required="#params.Required#"  DisplayName="#params.Title#" Description="#params.Description#" Group="SPA FORMS 365" StaticName="#params.InternalName#" AllowDeletion="TRUE"></Field>'}},{viewModel:t,template:e}}),define("text!datetimebox.xml",[],function(){return'<div data-bind="$init:{}, css: {\'ge-designmode\': designmode}">\r\n\t<label class="ms-Label" data-bind="text: title, visible: showTitle, css: enableRequired"></label>\r\n\t<div class="ms-DatePicker">\r\n\t  <div class="ms-TextField">\r\n\t\t<i class="ms-DatePicker-event ms-Icon ms-Icon--Event"></i>\r\n\t\t<input class="ms-TextField-field is-formfield" type="text" data-bind="textInput: value, enable: enableValue, enterkey: {}" placeholder="Select a date ..."/>\r\n\t  </div>\r\n\t  <div class="ms-DatePicker-monthComponents">\r\n\t\t<span class="ms-DatePicker-nextMonth js-nextMonth"><i class="ms-Icon ms-Icon--ChevronRight"></i></span>\r\n\t\t<span class="ms-DatePicker-prevMonth js-prevMonth"><i class="ms-Icon ms-Icon--ChevronLeft"></i></span>\r\n\t\t<div class="ms-DatePicker-headerToggleView js-showMonthPicker"></div>\r\n\t  </div>\r\n\t  <span class="ms-DatePicker-goToday js-goToday">Go to today</span>\r\n\t  <div class="ms-DatePicker-monthPicker">\r\n\t\t<div class="ms-DatePicker-header">\r\n\t\t  <div class="ms-DatePicker-yearComponents">\r\n\t\t\t<span class="ms-DatePicker-nextYear js-nextYear"><i class="ms-Icon ms-Icon--ChevronRight"></i></span>\r\n\t\t\t<span class="ms-DatePicker-prevYear js-prevYear"><i class="ms-Icon ms-Icon--ChevronLeft"></i></span>\r\n\t\t  </div>\r\n\t\t  <div class="ms-DatePicker-currentYear js-showYearPicker"></div>\r\n\t\t</div>\r\n\t\t<div class="ms-DatePicker-optionGrid">\r\n\t\t  <span class="ms-DatePicker-monthOption js-changeDate" data-month="0">Jan</span>\r\n\t\t  <span class="ms-DatePicker-monthOption js-changeDate" data-month="1">Feb</span>\r\n\t\t  <span class="ms-DatePicker-monthOption js-changeDate" data-month="2">Mar</span>\r\n\t\t  <span class="ms-DatePicker-monthOption js-changeDate" data-month="3">Apr</span>\r\n\t\t  <span class="ms-DatePicker-monthOption js-changeDate" data-month="4">May</span>\r\n\t\t  <span class="ms-DatePicker-monthOption js-changeDate" data-month="5">Jun</span>\r\n\t\t  <span class="ms-DatePicker-monthOption js-changeDate" data-month="6">Jul</span>\r\n\t\t  <span class="ms-DatePicker-monthOption js-changeDate" data-month="7">Aug</span>\r\n\t\t  <span class="ms-DatePicker-monthOption js-changeDate" data-month="8">Sep</span>\r\n\t\t  <span class="ms-DatePicker-monthOption js-changeDate" data-month="9">Oct</span>\r\n\t\t  <span class="ms-DatePicker-monthOption js-changeDate" data-month="10">Nov</span>\r\n\t\t  <span class="ms-DatePicker-monthOption js-changeDate" data-month="11">Dec</span>\r\n\t\t</div>\r\n\t  </div>\r\n\t  <div class="ms-DatePicker-yearPicker">\r\n\t\t<div class="ms-DatePicker-decadeComponents">\r\n\t\t  <span class="ms-DatePicker-nextDecade js-nextDecade"><i class="ms-Icon ms-Icon--ChevronRight"></i></span>\r\n\t\t  <span class="ms-DatePicker-prevDecade js-prevDecade"><i class="ms-Icon ms-Icon--ChevronLeft"></i></span>\r\n\t\t</div>\r\n\t  </div>\r\n\t</div>\r\n\t\r\n</div>\r\n'}),define("text!numberbox.xml",[],function(){return'<div data-bind="css: {\'ge-designmode\': designmode}">\r\n\t<label class="ms-Label" data-bind="text: title, visible: showTitle, css: enableRequired"></label>\r\n\t<div class="ms-TextField ms-TextField--placeholder" >\r\n\t\t<label class="ms-Label" style="display: none;" data-bind="text: description, style: {display: enableDescription()}"></label>\r\n\t\t<input class="ms-TextField-field is-formfield" style="z-index:0" type="text" data-bind="textInput: value, enable: enableValue, enterkey: {}" />\r\n\t</div>\r\n</div>\r\n'}),define("numberbox",["text!numberbox.xml"],function(e){function t(e){this.internalName=e?e.InternalName:"";var t=e.parentContext().spaform,i=t.runtime;this.readonly=i.dataContext(e.namespace).readonly,this.designmode=i.designMode,this.title=ko.observable(e?e.Title:""),this.description=ko.observable(e?e.Description:""),this.required=ko.observable(!!e&&(!!e.Required&&e.Required)),this.readonlyfield=ko.observable(!!e&&(!!e.ReadOnlyField&&e.ReadOnlyField)),this.max=ko.observable(!!e&&(!!e.MaximumValue&&e.MaximumValue)),this.min=ko.observable(!!e&&(!!e.MinimumValue&&e.MinimumValue)),this.defaultvalue=ko.observable(e&&e.DefaultValue?e.DefaultValue:""),this.percentage=ko.observable(!!e&&(!!e.Percentage&&e.Percentage)),this.value=ko.observable().extend({namespace:e});this.value();this.value.subscribe(function(e){},this),this.value.extend({required:this.required()}).extend({number:!0}),this.max()&&this.value.extend({max:this.percentage()?100*this.max():this.max()}),this.min()&&this.value.extend({min:this.percentage()?100*this.min():this.min()}),this.enableValue=ko.pureComputed(function(){return this.$enabled()},this),this.enableDescription=ko.pureComputed(function(){return 0===this.value().length?"block":"none"},this),this.enableRequired=ko.pureComputed(function(){return this.required()?"is-required":""},this),this.showTitle=ko.pureComputed(function(){return!!(this.title()&&this.title().length>0)},this)}return function(){this.$enabled=function(){return!this.readonly()&&!this.readonlyfield()}}.call(t.prototype),t.prototype.schema={Params:{name:"",namespace:"listItem",promoted:!0,InternalName:"",Title:"",Description:"",MaximumValue:100,MinimumValue:0,DefaultValue:!1,ReadOnlyField:!1,Percentage:!1,FieldTypeKind:9,Required:!1},Permalink:"https://spaforms365.com/docs/syslib-numberbox/",Connections:{ListItem:["Number"],PromotedColumnXml:'<Field Type="Number"  Name="#params.InternalName#" DisplayName="#params.Title#" Percentage="#params.Percentage#" Group="SPA FORMS 365" StaticName="#params.InternalName#" AllowDeletion="TRUE"></Field>'}},{viewModel:t,template:e}}),define("text!currencybox.xml",[],function(){return'<div data-bind="css: {\'ge-designmode\': designmode}">\r\n\t<label class="ms-Label" data-bind="text: title, visible: showTitle, css: enableRequired"></label>\r\n\t<div class="ms-TextField ms-TextField--placeholder" >\r\n\t\t<label class="ms-Label" style="display: none;" data-bind="text: description, style: {display: enableDescription()}"></label>\r\n\t\t<input class="ms-TextField-field is-formfield" style="z-index:0"  type="text" data-bind="textInput: value, enable: enableValue, enterkey: {}" />\r\n\t</div>\r\n</div>\r\n'}),define("currencybox",["text!currencybox.xml"],function(e){function t(e){this.internalName=e?e.InternalName:"";var t=e.parentContext().spaform,i=t.runtime;this.readonly=i.dataContext(e.namespace).readonly,this.designmode=i.designMode,this.title=ko.observable(e?e.Title:""),this.description=ko.observable(e?e.Description:""),this.required=ko.observable(!!e&&(!!e.Required&&e.Required)),this.readonlyfield=ko.observable(!!e&&(!!e.ReadOnlyField&&e.ReadOnlyField)),this.max=ko.observable(!!e&&(!!e.MaximumValue&&e.MaximumValue)),this.min=ko.observable(!!e&&(!!e.MinimumValue&&e.MinimumValue)),this.defaultvalue=ko.observable(e&&e.DefaultValue?e.DefaultValue:""),this.value=ko.observable().extend({namespace:e}),ko.validation&&(this.value.extend({required:this.required()}).extend({number:!0}),this.max()&&this.value.extend({max:this.max()}),this.min()&&this.value.extend({min:this.min()})),this.enableValue=ko.pureComputed(function(){return this.$enabled()},this),this.enableDescription=ko.pureComputed(function(){return 0===this.value().length?"block":"none"},this),this.enableRequired=ko.pureComputed(function(){return this.required()?"is-required":""},this),this.showTitle=ko.pureComputed(function(){return!!(this.title()&&this.title().length>0)},this)}return function(){this.$enabled=function(){return!this.readonly()&&!this.readonlyfield()}}.call(t.prototype),t.prototype.schema={Params:{name:"",namespace:"listItem",promoted:!0,InternalName:"",Title:"",Description:"",MaximumValue:!1,MinimumValue:!1,DefaultValue:!1,ReadOnlyField:!1,FieldTypeKind:10,LCID:1033,Decimals:2,Required:!1},Permalink:"https://spaforms365.com/docs/syslib-currencybox/",Connections:{ListItem:["Currency"],PromotedColumnXml:'<Field Type="Currency"  Name="#params.InternalName#" Required="#params.Required#"  DisplayName="#params.Title#" Description="#params.Description#" Decimals="#params.Decimals#" Group="SPA FORMS 365" Max="#params.MaximumValue#" Min="#params.MinimumValue#"  LCID="#params.LCID#" StaticName="#params.InternalName#" AllowDeletion="TRUE"></Field>'}},{viewModel:t,template:e}}),define("text!filebox.xml",[],function(){return'<div data-bind="$init: {}, css: {\'ge-designmode\': designmode}">\r\n\t<label class="ms-Label" data-bind="text: title, visible: showTitle, css: enableRequired"></label>\r\n    <div class="ms-PeoplePicker ms-PeoplePicker--compact">\r\n\t   <i class="ms-DatePicker-event ms-Icon ms-Icon--Attach" style="padding-top:10px;bottom:auto;right:15px;"></i>\r\n       <div class="ms-PeoplePicker-searchBox" data-bind="css: enableValue">\r\n \t\t\t<div class="ms-PeoplePicker-resultGroup" data-bind="foreach: {data: results, as: \'persona\'}">\r\n                <span class="ms-FilePicker-result " tabindex="1">\r\n                    <div class="ms-Persona ms-Persona--xs ms-Persona--token ms-PeoplePicker-persona" >\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<i class="ms-Icon ms-Icon--Page" style="font-size:x-large" aria-hidden="true"></i>\t\t\t\t\t\t\r\n\t\t\t\t\t\t</div>\r\n                        <div class="ms-Persona-details" style="padding-left:5px;">\r\n                            <div class="ms-Persona-primaryText ms-FilePicker--filename" data-bind="visible: persona.showText, text: persona.newFileName"></div>\r\n                            <div class="ms-Persona-primaryText ms-FilePicker--filelink" data-bind="visible: persona.showLink"><b><a class="ms-FilePicker--filelink2" data-bind="attr: { href: persona.url, title: persona.oldFileName}"><span data-bind="text: persona.oldFileName"></span></a></b></div>\r\n                            <div class="ms-Persona-secondaryText" data-bind="text: persona.secondaryText"></div>\r\n \t\t\t\t\t\t</div>\r\n                        <div class="ms-Persona-actionIcon" data-bind="click: persona.onremove, visible: $parent.showValue">\r\n\t\t\t\t\t\t\t<i class="ms-Icon ms-Icon--Cancel"></i>\t\t\t\t\t\t\r\n\t\t\t\t\t\t</div>\r\n                    </div>\r\n                </span>\r\n\t\t\t</div>\r\n            <div class="ms-TextField  ms-TextField--textFieldUnderlined " data-bind="visible: showValue">\r\n                <input class="ms-TextField-field is-formfield" type="text" data-bind="click: addFile, attr: {placeholder: description}, enterkey: {}" value=""/>\r\n            </div>\r\n        </div>\r\n    </div>\t\t\t\r\n</div>\r\n'}),define("text!notebox.xml",[],function(){return'<div data-bind="$init:{}, css: {\'ge-designmode\': designmode}">\r\n\t<label class="ms-Label" data-bind="text: title, visible: showTitle, css: enableRequired"></label>\r\n\t<div class="ms-TextField  ms-TextField--placeholder" >\r\n\t\t<label class="ms-Label" style="display: none;" data-bind="text: description, style: {display: enableDescription()}"></label>\r\n\t\t<textarea class="ms-TextField-field is-formfield validationBox"  style="height: auto; z-index:0" type="text" data-bind="textInput: value, attr: {rows: numlines}, enable: enableValue, enterkey: {}"></textarea>\r\n\t</div>\r\n</div>\r\n'}),define("notebox",["text!notebox.xml"],function(e){function t(e){this.internalName=e?e.InternalName:"";var t=e.parentContext().spaform,i=t.runtime;this.readonly=i.dataContext(e.namespace).readonly,this.designmode=i.designMode,this.title=ko.observable(e?e.Title:""),this.description=ko.observable(e?e.Description:""),this.required=ko.observable(!!e&&(!!e.Required&&e.Required)),this.readonlyfield=ko.observable(!!e&&(!!e.ReadOnlyField&&e.ReadOnlyField)),this.maxlength=ko.observable(e&&e.MaxLength?e.MaxLength:1e4),this.defaultvalue=ko.observable(e&&e.DefaultValue?e.DefaultValue:""),this.numlines=ko.observable(e.NumLines),this.value=ko.observable().extend({namespace:e}),this.value.extend({required:this.required()}).extend({maxLength:e.MaxLength}),this.enableValue=ko.pureComputed(function(){return this.$enabled()},this),this.enableDescription=ko.pureComputed(function(){return this.value()&&0===this.value().length?"block":"none"},this),this.enableRequired=ko.pureComputed(function(){return this.required()?"is-required":""},this),this.showTitle=ko.pureComputed(function(){return!!(this.title()&&this.title().length>0)},this)}return function(){this.$enabled=function(){return!this.readonly()&&!this.readonlyfield()},this.$init=function(e){for(var t=e.querySelectorAll(".ms-TextField"),i=0;i<t.length;i++)this.fabricObject=new fabric.TextField(t[i])}}.call(t.prototype),t.prototype.schema={Params:{name:"",namespace:"listItem",promoted:!0,InternalName:"",Title:"",Description:"",MaxLength:1e4,RichText:!1,NumLines:6,DefaultValue:"",FieldTypeKind:3,ReadOnlyField:!1,Required:!1},Permalink:"https://spaforms365.com/docs/syslib-notebox/",Connections:{ListItem:["Note"],PromotedColumnXml:'<Field Type="Note" Name="#params.InternalName#" Required="#params.Required#"  DisplayName="#params.Title#" Description="#params.Description#" Group="SPA FORMS 365" RichText="#params.RichText#" NumLines="#params.NumLines#"  StaticName="#params.InternalName#" AllowDeletion="TRUE"></Field>'}},{viewModel:t,template:e}}),define("text!lookupbox.xml",[],function(){return'<div data-bind="$init: {}, css: {\'ge-designmode\': designmode}">\r\n\t<label class="ms-Label" data-bind="text: title, visible: showTitle, css: enableRequired"></label>\r\n\t<div class="ms-Dropdown is-formfield" tabindex="0" data-bind="css: enableValue, enterkey: {}">\r\n\t\t<i class="ms-Dropdown-caretDown ms-Icon ms-Icon--ChevronDown"></i>\r\n\t\t<select class="ms-Dropdown-select" data-bind=" optionsCaption: description, options: choices, optionsText: \'Title\'"></select>\r\n\t</div>\r\n</div>\r\n'}),define("lookupbox",["text!lookupbox.xml"],function(e){function t(e){this.internalName=e?e.InternalName:"";var t=e.parentContext().spaform,i=t.runtime;this.runtime=ko.observable(i),this.readonly=i.dataContext(e.namespace).readonly,this.designmode=i.designMode,this.title=ko.observable(e?e.Title:""),this.lookupField=e.LookupField,this.lookupList=e.LookupList,this.lookupWebId=e.LookupWebId,this.choices=ko.observableArray([]),this.description=ko.observable(e&&e.Description&&e.Description.length>0?e.Description:"Select..."),this.required=ko.observable(!!e&&(!!e.Required&&e.Required)),this.readonlyfield=ko.observable(!!e&&(!!e.ReadOnlyField&&e.ReadOnlyField)),this.defaultvalue=ko.observable(e&&e.DefaultValue?e.DefaultValue:""),this.value=ko.observable().extend({namespace:e}),this.value.subscribe(function(e){var t=this;e&&e.__deferred&&setTimeout(function(){t.value(void 0)},100)},this),ko.validation&&this.value.extend({required:this.required()}),this.enableValue=ko.pureComputed(function(){return this.$enabled()?"":"is-disabled"},this),this.enableRequired=ko.pureComputed(function(){return this.required()?"is-required":""},this),this.showTitle=ko.pureComputed(function(){return!!(this.title()&&this.title().length>0)},this)}return fabric.Dropdown.prototype._checkTruncation=function(){var e=this._container.getAttribute("fulltitle");if(e){if(this._dropdownLabelHelper.textContent=e,this._dropdownLabelHelper.offsetHeight>this._newDropdownLabel.offsetHeight){var t=0,i=void 0;do{t--,i=e.slice(0,t),this._dropdownLabelHelper.textContent=i+"..."}while(this._dropdownLabelHelper.offsetHeight>this._newDropdownLabel.offsetHeight)}this._newDropdownLabel.textContent=this._dropdownLabelHelper.textContent}},function(){this.$enabled=function(){return!this.readonly()&&!this.readonlyfield()},this.$init=function(e){var t=this,i={LookupField:this.lookupField,LookupList:this.lookupList,LookupWebId:this.lookupWebId};this.runtime()._formLookupQuery(i).done(function(i){t.choices(i),setTimeout(function(){var i=e.querySelector(".ms-Dropdown");if(t.fabricObject=new fabric.Dropdown(i),t.fabricObject._dropdownIcon=t.fabricObject._container.querySelector(".ms-Dropdown-caretDown"),t.fabricObject._newDropdownLabel.innerHTML=t.value()?t.value()[t.lookupField]:"",t.fabricObject._container.setAttribute("fulltitle",t.value()?t.value()[t.lookupField]:t.description()),t.fabricObject._checkTruncation(),t.fabricObject._originalDropdown.addEventListener("change",function(e){for(var i=0,n=0;n<t.fabricObject._dropdownItems.length;++n)t.fabricObject._dropdownItems[n].oldOption.selected&&(i=n);t.value(0==i?void 0:t.choices()[i-1]),t.fabricObject._container.setAttribute("fulltitle",t.value()?t.value().Title:t.description()),t.fabricObject._checkTruncation()},!1),ko.validation){var n=ko.validation.insertValidationMessage(t.fabricObject._newDropdownLabel);ko.applyBindingsToNode(n,{validationMessage:t.value}),ko.applyBindingsToNode(t.fabricObject._newDropdownLabel,{validationElement:t.value}),ko.applyBindingsToNode(t.fabricObject._dropdownIcon,{validationElement:t.value})}},200)})}}.call(t.prototype),t.prototype.schema={Params:{name:"",namespace:"listItem",promoted:!0,InternalName:"",Title:"",AllowMultipleValues:!1,Description:"",DefaultValue:!1,IsRelationship:!1,LookupField:!1,LookupList:!1,LookupWebId:!1,PrimaryFieldId:null,ReadOnlyField:!1,FieldTypeKind:0,Required:!1},Permalink:"https://spaforms365.com/docs/syslib-lookupbox/",Connections:{ListItem:["Lookup"]}},{viewModel:t,template:e}}),define("text!../Runtime/source/syscomponents/datepicker.min.css",[],function(){
return"/* Copyright (c) Microsoft. All rights reserved. Licensed under the MIT license. See LICENSE in the project root for license information. */\r\n.ms-TextField{color:#333;font-family:Segoe UI Regular WestEuropean,Segoe UI,Tahoma,Arial,sans-serif;font-size:14px;font-weight:400;box-sizing:border-box;margin:0;padding:0;box-shadow:none;margin-bottom:8px}.ms-TextField.is-disabled .ms-TextField-field{background-color:#f4f4f4;border-color:#f4f4f4;pointer-events:none;cursor:default}.ms-TextField.is-disabled:-moz-placeholder,.ms-TextField.is-disabled:-ms-input-placeholder,.ms-TextField.is-disabled::-moz-placeholder,.ms-TextField.is-disabled::-webkit-input-placeholder{color:#a6a6a6}.ms-TextField.is-required .ms-Label:after{content:' *';color:#a80000}.ms-TextField.is-required:-moz-placeholder:after,.ms-TextField.is-required:-ms-input-placeholder:after,.ms-TextField.is-required::-moz-placeholder:after,.ms-TextField.is-required::-webkit-input-placeholder:after{content:' *';color:#a80000}.ms-TextField.is-active{border-color:#0078d7}.ms-TextField-field{box-sizing:border-box;margin:0;padding:0;box-shadow:none;border:1px solid #c8c8c8;border-radius:0;font-family:Segoe UI Semilight WestEuropean,Segoe UI Semilight,Segoe UI,Tahoma,Arial,sans-serif;font-size:12px;color:#333;height:32px;padding:6px 10px 8px;width:100%;min-width:180px;outline:0}.ms-TextField-field:hover{border-color:#767676}.ms-TextField-field:focus{border-color:#0078d7}@media screen and (-ms-high-contrast:active){.ms-TextField-field:focus,.ms-TextField-field:hover{border-color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.ms-TextField-field:focus,.ms-TextField-field:hover{border-color:#37006e}}.ms-TextField-field:-moz-placeholder,.ms-TextField-field:-ms-input-placeholder,.ms-TextField-field::-moz-placeholder,.ms-TextField-field::-webkit-input-placeholder{color:#666}.ms-TextField-description{color:#767676;font-size:11px}.ms-TextField.ms-TextField--placeholder{position:relative}.ms-TextField.ms-TextField--placeholder .ms-Label{position:absolute;font-family:Segoe UI Semilight WestEuropean,Segoe UI Semilight,Segoe UI,Tahoma,Arial,sans-serif;font-size:12px;color:#666;padding:7px 0 7px 10px}.ms-TextField.ms-TextField--placeholder.is-disabled,.ms-TextField.ms-TextField--placeholder.is-disabled .ms-Label{color:#a6a6a6}@media screen and (-ms-high-contrast:active){.ms-TextField.ms-TextField--placeholder.is-disabled .ms-Label{color:#0f0}}@media screen and (-ms-high-contrast:black-on-white){.ms-TextField.ms-TextField--placeholder.is-disabled .ms-Label{color:#600000}}.ms-TextField.ms-TextField--underlined{border-bottom:1px solid #c8c8c8;display:table;width:100%;min-width:180px}.ms-TextField.ms-TextField--underlined:hover{border-color:#767676}@media screen and (-ms-high-contrast:active){.ms-TextField.ms-TextField--underlined:hover{border-color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.ms-TextField.ms-TextField--underlined:hover{border-color:#37006e}}.ms-TextField.ms-TextField--underlined:active,.ms-TextField.ms-TextField--underlined:focus{border-color:#0078d7}.ms-TextField.ms-TextField--underlined .ms-Label{font-size:12px;margin-right:8px;display:table-cell;vertical-align:bottom;padding-left:12px;padding-bottom:5px;height:32px;width:1%;white-space:nowrap}.ms-TextField.ms-TextField--underlined .ms-TextField-field{border:0;float:left;display:table-cell;text-align:left;padding-top:8px;padding-bottom:2px}.ms-TextField.ms-TextField--underlined .ms-TextField-field:active,.ms-TextField.ms-TextField--underlined .ms-TextField-field:focus,.ms-TextField.ms-TextField--underlined .ms-TextField-field:hover{outline:0}.ms-TextField.ms-TextField--underlined.is-disabled{border-bottom-color:#eaeaea}.ms-TextField.ms-TextField--underlined.is-disabled .ms-Label{color:#a6a6a6}@media screen and (-ms-high-contrast:active){.ms-TextField.ms-TextField--underlined.is-disabled .ms-Label{color:#0f0}}@media screen and (-ms-high-contrast:black-on-white){.ms-TextField.ms-TextField--underlined.is-disabled .ms-Label{color:#600000}}.ms-TextField.ms-TextField--underlined.is-disabled .ms-TextField-field{background-color:transparent;color:#a6a6a6}.ms-TextField.ms-TextField--underlined.is-active{border-color:#0078d7}@media screen and (-ms-high-contrast:active){.ms-TextField.ms-TextField--underlined.is-active{border-color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.ms-TextField.ms-TextField--underlined.is-active{border-color:#37006e}}.ms-TextField.ms-TextField--multiline .ms-TextField-field{line-height:17px;min-height:60px;min-width:260px;padding-top:6px;overflow:auto}.ms-Label,.ms-TextField.ms-TextField--multiline .ms-TextField-field{color:#333;font-family:Segoe UI Regular WestEuropean,Segoe UI,Tahoma,Arial,sans-serif;font-size:12px;font-weight:400}.ms-Label{margin:0;padding:0;box-shadow:none;box-sizing:border-box;display:block;padding:5px 0}.ms-Label.is-required:after{content:' *';color:#a80000}.ms-Label.is-disabled{color:#a6a6a6}@media screen and (-ms-high-contrast:active){.ms-Label.is-disabled{color:#0f0}}@media screen and (-ms-high-contrast:black-on-white){.ms-Label.is-disabled{color:#600000}}.is-disabled .ms-Label{color:#a6a6a6}@media screen and (-ms-high-contrast:active){.is-disabled .ms-Label{color:#0f0}}@media screen and (-ms-high-contrast:black-on-white){.is-disabled .ms-Label{color:#600000}}.ms-Link{color:#0078d7;text-decoration:none;cursor:pointer}.ms-Link:focus,.ms-Link:hover{color:#004578}.ms-Link:active{color:#0078d7}@media screen and (-ms-high-contrast:active){.ms-Link{color:#8080ff}}@media screen and (-ms-high-contrast:black-on-white){.ms-Link{color:#00009f}}.ms-DatePicker{box-sizing:border-box;margin:0;padding:0;box-shadow:none;margin-bottom:17px;z-index:3}.ms-DatePicker .ms-TextField{position:relative}.ms-DatePicker-picker{color:#000;font-size:14px;position:relative;text-align:left;z-index:0}.ms-DatePicker-event{color:#666;font-size:21px;line-height:20px;pointer-events:none;position:absolute;right:5px;bottom:5px;z-index:1}.ms-DatePicker-holder{-webkit-overflow-scrolling:touch;box-sizing:border-box;background:#fff;position:absolute;min-width:300px;display:none}.ms-DatePicker-picker.ms-DatePicker-picker--opened .ms-DatePicker-holder{-webkit-animation-name:fadeIn,slideDownIn10;animation-name:fadeIn,slideDownIn10;-webkit-animation-duration:.167s;-moz-animation-duration:.167s;-ms-animation-duration:.167s;-o-animation-duration:.167s;-webkit-animation-timing-function:cubic-bezier(.1,.25,.75,.9);animation-timing-function:cubic-bezier(.1,.25,.75,.9);-webkit-animation-fill-mode:both;animation-fill-mode:both;box-sizing:border-box;box-shadow:0 0 5px 0 rgba(0,0,0,.4);border:1px solid #eaeaea;display:block}.ms-DatePicker-picker--opened{position:relative;z-index:2}.ms-DatePicker-frame{padding:1px}.ms-DatePicker-wrap{margin:-1px;padding:9px}.ms-DatePicker-dayPicker{display:block;margin-bottom:30px}.ms-DatePicker-header{height:40px;line-height:44px}.ms-DatePicker-month,.ms-DatePicker-year{display:inline-block;font-family:Segoe UI Light WestEuropean,Segoe UI Light,Segoe UI,Tahoma,Arial,sans-serif;font-size:21px;color:#0078d7;margin-top:-1px}.ms-DatePicker-month:hover,.ms-DatePicker-year:hover{color:#005a9e;cursor:pointer}.ms-DatePicker-month{margin-left:15px}.ms-DatePicker-year{margin-left:5px}.ms-DatePicker-table{text-align:center;border-collapse:collapse;border-spacing:0;table-layout:fixed;font-size:inherit}.ms-DatePicker-table td{margin:0;padding:0}.ms-DatePicker-table td:hover{outline:1px solid transparent}.ms-DatePicker-day,.ms-DatePicker-weekday{width:40px;height:40px;padding:0;line-height:40px;font-family:Segoe UI Regular WestEuropean,Segoe UI,Tahoma,Arial,sans-serif;font-size:15px;font-weight:400;color:#333}.ms-DatePicker-day--today{position:relative;background-color:#c7e0f4}.ms-DatePicker-day--disabled:before{border-top-color:#a6a6a6}.ms-DatePicker-day--outfocus{color:#a6a6a6;font-family:Segoe UI Regular WestEuropean,Segoe UI,Tahoma,Arial,sans-serif}.ms-DatePicker-day--infocus:hover,.ms-DatePicker-day--outfocus:hover{cursor:pointer;color:#000;background:#eaeaea}.ms-DatePicker-day--highlighted:hover,.ms-DatePicker-picker--focused .ms-DatePicker-day--highlighted{cursor:pointer;color:#fff;background:#0078d7}.ms-DatePicker-day--highlighted.ms-DatePicker-day--disabled,.ms-DatePicker-day--highlighted.ms-DatePicker-day--disabled:hover{background:#a6a6a6}.ms-DatePicker-monthPicker,.ms-DatePicker-yearPicker{display:none}.ms-DatePicker-monthComponents{position:absolute;top:9px;right:9px;left:9px}.ms-DatePicker-decadeComponents,.ms-DatePicker-yearComponents{position:absolute;right:10px}.ms-DatePicker-nextDecade,.ms-DatePicker-nextMonth,.ms-DatePicker-nextYear,.ms-DatePicker-prevDecade,.ms-DatePicker-prevMonth,.ms-DatePicker-prevYear{width:40px;height:40px;display:block;float:right;margin-left:10px;line-height:40px;text-align:center;font-size:21px;color:#666;position:relative;top:3px}.ms-DatePicker-nextDecade:hover,.ms-DatePicker-nextMonth:hover,.ms-DatePicker-nextYear:hover,.ms-DatePicker-prevDecade:hover,.ms-DatePicker-prevMonth:hover,.ms-DatePicker-prevYear:hover{color:#212121;cursor:pointer;outline:1px solid transparent}.ms-DatePicker-headerToggleView{height:40px;left:0;position:absolute;top:0;width:140px;z-index:1;cursor:pointer}.ms-DatePicker-currentDecade,.ms-DatePicker-currentYear{display:block;font-weight:400;font-family:Segoe UI Semilight WestEuropean,Segoe UI Semilight,Segoe UI,Tahoma,Arial,sans-serif;font-size:21px;height:40px;line-height:42px;margin-left:15px}.ms-DatePicker-currentYear{color:#0078d7}.ms-DatePicker-currentYear:hover{color:#005a9e;cursor:pointer}.ms-DatePicker-optionGrid{position:relative;height:210px;width:280px;margin:10px 0 30px 5px}.ms-DatePicker-monthOption,.ms-DatePicker-yearOption{background-color:#f4f4f4;width:60px;height:60px;line-height:60px;cursor:pointer;float:left;margin:0 10px 10px 0;font-weight:400;font-family:Segoe UI Regular WestEuropean,Segoe UI,Tahoma,Arial,sans-serif;font-size:13px;color:#333;text-align:center}.ms-DatePicker-monthOption:hover,.ms-DatePicker-yearOption:hover{background-color:#c8c8c8;outline:1px solid transparent}.ms-DatePicker-monthOption.is-highlighted,.ms-DatePicker-yearOption.is-highlighted{background-color:#333;color:#fff}.ms-DatePicker-goToday{bottom:9px;color:#0078d7;cursor:pointer;font-family:Segoe UI Semilight WestEuropean,Segoe UI Semilight,Segoe UI,Tahoma,Arial,sans-serif;font-size:13px;height:30px;line-height:30px;padding:0 10px;position:absolute;right:9px}.ms-DatePicker-goToday:hover{outline:1px solid transparent}.ms-DatePicker.is-pickingYears .ms-DatePicker-dayPicker,.ms-DatePicker.is-pickingYears .ms-DatePicker-monthComponents,.ms-DatePicker.is-pickingYears .ms-DatePicker-monthPicker{display:none}.ms-DatePicker.is-pickingYears .ms-DatePicker-yearPicker{display:block}@media (min-width:460px){.ms-DatePicker-holder{width:440px}.ms-DatePicker-month,.ms-DatePicker-year{font-family:Segoe UI Semilight WestEuropean,Segoe UI Semilight,Segoe UI,Tahoma,Arial,sans-serif}.ms-DatePicker-header{height:30px;line-height:28px}.ms-DatePicker-dayPicker{box-sizing:border-box;border-right:1px solid #eaeaea;width:220px}.ms-DatePicker-monthPicker{display:block}.ms-DatePicker-dayPicker{margin:-10px 0;padding:10px 0}.ms-DatePicker-monthPicker,.ms-DatePicker-yearPicker{top:9px;left:238px;position:absolute}.ms-DatePicker-optionGrid{width:200px;height:auto;margin:10px 0 0}.ms-DatePicker-monthComponents{width:210px}.ms-DatePicker-month{margin-left:12px}.ms-DatePicker-month,.ms-DatePicker-year{font-size:17px;color:#333}.ms-DatePicker-month:hover,.ms-DatePicker-year:hover{color:#333;cursor:default}.ms-DatePicker-day,.ms-DatePicker-weekday{width:30px;height:30px;line-height:30px;font-family:Segoe UI Semibold WestEuropean,Segoe UI Semibold,Segoe UI,Tahoma,Arial,sans-serif;font-size:12px}.ms-DatePicker-nextDecade,.ms-DatePicker-nextMonth,.ms-DatePicker-nextYear,.ms-DatePicker-prevDecade,.ms-DatePicker-prevMonth,.ms-DatePicker-prevYear{font-size:17px;width:30px;height:30px;line-height:29px}.ms-DatePicker-toggleMonthView{display:none}.ms-DatePicker-currentDecade,.ms-DatePicker-currentYear{font-size:17px;margin:0;height:30px;line-height:26px;padding:0 10px;display:inline-block}.ms-DatePicker-monthOption,.ms-DatePicker-yearOption{width:40px;height:40px;line-height:40px;font-size:12px;margin:0 10px 10px 0}.ms-DatePicker-monthOption:hover,.ms-DatePicker-yearOption:hover{outline:1px solid transparent}.ms-DatePicker-goToday{box-sizing:border-box;font-size:12px;height:30px;line-height:30px;padding:0 10px;right:10px;text-align:right;top:199px;width:210px}.ms-DatePicker.is-pickingYears .ms-DatePicker-dayPicker,.ms-DatePicker.is-pickingYears .ms-DatePicker-monthComponents{display:block}.ms-DatePicker.is-pickingYears .ms-DatePicker-monthPicker{display:none}.ms-DatePicker.is-pickingYears .ms-DatePicker-yearPicker{display:block}}@media (max-width:459px){.ms-DatePicker.is-pickingMonths .ms-DatePicker-dayPicker,.ms-DatePicker.is-pickingMonths .ms-DatePicker-monthComponents{display:none}.ms-DatePicker.is-pickingMonths .ms-DatePicker-monthPicker{display:block}}"}),define("datetimebox",["text!datetimebox.xml","text!./../Runtime/source/syscomponents/datepicker.min.css","./../Runtime/source/syscomponents/pickadate"],function(e,t){function i(e){var t=this;this.internalName=e?e.InternalName:"";var i=e.parentContext().spaform,n=i.runtime;this.readonly=n.dataContext(e.namespace).readonly,this.designmode=n.designMode,this.title=ko.observable(e?e.Title:""),this.description=ko.observable(e?e.Description:""),this.required=ko.observable(!!e&&(!!e.Required&&e.Required)),this.readonlyfield=ko.observable(!!e&&(!!e.ReadOnlyField&&e.ReadOnlyField)),this.defaultvalue=ko.observable(e&&e.DefaultValue?e.DefaultValue:"");var a=function(e){if(e&&e.indexOf("-")>0){var i=new Date(e);this.fabricObject&&this.fabricObject.picker.set("select",[i.getFullYear(),i.getMonth(),i.getDate()])}null==e&&t.value("")};this.value=ko.observable().extend({namespace:e}),a(this.value()),this.value.subscribe(function(e){a(e)},this),ko.validation&&this.value.extend({required:this.required()}),this.enableValue=ko.pureComputed(function(){return this.$enabled()},this),this.enableRequired=ko.pureComputed(function(){return this.required()?"is-required":""},this),this.showTitle=ko.pureComputed(function(){return!!(this.title()&&this.title().length>0)},this),setTimeout(function(){$(".ms-DatePicker-monthPicker").show(),$(".ms-DatePicker-monthComponents").show(),$(".ms-DatePicker-dayPicker").show()},500)}return function(e){var t=document.createElement("style");document.body.appendChild(t),t.innerHTML=e}(t),function(){this.$enabled=function(){return!this.readonly()&&!this.readonlyfield()},this.$init=function(e){var t=this;if("undefined"!=typeof fabric&&"DatePicker"in fabric)for(var i=e.querySelectorAll(".ms-DatePicker"),n=i.length;n--;){if(this.fabricObject=new fabric.DatePicker(i[n]),this.fabricObject.picker.on({set:function(e){"object"==typeof e&&t.value(t.fabricObject.picker.get("select","dd mmmm, yyyy"))}}),""!=this.value()){var a=new Date(this.value());a&&this.fabricObject.picker.set("select",[a.getFullYear(),a.getMonth(),a.getDate()])}this.fabricObject._dropdownIcon=i[n].querySelector(".ms-DatePicker-event"),ko.validation&&ko.applyBindingsToNode(this.fabricObject._dropdownIcon,{validationElement:this.value})}}}.call(i.prototype),i.prototype.schema={Params:{name:"",namespace:"listItem",promoted:!0,InternalName:"",Title:"",Description:"",Format:"DateOnly",FriendlyDisplayFormat:"Relative",DefaultValue:"",ReadOnlyField:!1,DisplayFormat:!1,FriendlyDisplayFormat:!1,FieldTypeKind:4,Required:!1},Permalink:"https://spaforms365.com/docs/syslib-datetimebox/",Connections:{ListItem:["DateTime"],PromotedColumnXml:'<Field Type="DateTime"  Name="#params.InternalName#" Required="#params.Required#"  DisplayName="#params.Title#" Description="#params.Description#"  Format="#params.DateOnly#" FriendlyDisplayFormat="#Relative#" Group="SPA FORMS 365" StaticName="#params.InternalName#" AllowDeletion="TRUE"></Field>'}},{viewModel:i,template:e}}),define("text!../syscomponents/filebox-handlelinks.css",[],function(){return"/*hover view styles*/\r\n.ms-srch-hover-content div {\r\n    overflow: hidden;\r\n}\r\n\r\n.ms-srch-hover-actions {\r\n    background: rgb(241, 241, 241);\r\n    padding: 17px 20px;\r\n    overflow: hidden;\r\n}\r\n\r\n\r\n\r\n.ms-srch-hover-action {\r\n    border-right: 1px solid #000000;\r\n}\r\n\r\n.ms-srch-hover-action.copyLinkContainer {\r\n    border-right: none;\r\n}\r\n\r\n.ms-srch-hover-content div {\r\n    overflow: hidden;\r\n}\r\n\r\n.ms-srch-hover-action {\r\n    padding-right: 10px;\r\n    margin-right: 10px;\r\n    padding-top: 3px;\r\n    float: left;\r\n}\r\n\r\n.ms-srch-hover-close {\r\n    width : 60px;\r\n    text-align: center;\r\n    padding: 2px 10px;\r\n    background-color: #5DA200;\r\n    float: right;\r\n}\r\n\r\n.ms-srch-hover-close>a {\r\n    text-decoration: none;\r\n    color: #FFFFFF;\r\n}\r\n\r\n.ms-srch-hover-copylinkinner {\r\n    width: 100%;\r\n    text-align: left;\r\n    padding-top: 5px;\r\n    font-size: 13px;\r\n    margin-top: 10px;\r\n    overflow: auto;\r\n    size: 100%;\r\n    word-wrap: true;\r\n    padding-left: 5px;\r\n    text-decoration: none;\r\n}\r\n\r\n.ms-srch-hover-content div {\r\n    overflow: hidden;\r\n}\r\n\r\n.copyLinkMessage {\r\n    padding: 0px 0px 5px 5px;\r\n}\r\n\r\n#copyDocumentLink {\r\n    width: 98%;\r\n    -moz-border-radius: 5px;\r\n    -webkit-border-radius: 5px;\r\n    border-radius: 5px;\r\n}\r\n\r\n.ms-srch-hover-header {\r\n    padding: 10px 0px 10px 40px;\r\n    word-wrap: break-word;\r\n}\r\n\r\n#s4-workspace #s4-bodyContainer {\r\n    padding-bottom: 0px;\r\n}\r\n.hidecopylinkinner{\r\n  display : none;\r\n}\r\n\r\n.showcopylinkinner{\r\n  display : block;\r\n}\r\n\r\n/*end of hover view styles*/\r\n\r\n/*dialog box css*/\r\n#externalLinkDialog{\r\n  display: none;\r\n}\r\n\r\n.ms-srch-hover-innerContainer2 {\r\n    position: relative;\r\n    margin: 0px;\r\n    background-color: #fff;\r\n    border: none;\r\n    padding: 0px;\r\n    box-shadow: none;\r\n    display: inline-block;\r\n    width : 100%;\r\n}"}),define("../Runtime/source/syscomponents/filebox-handlelinks",["text!./../../../syscomponents/filebox-handlelinks.css","jquery"],function(e,t){function i(){t("a.handleThisAnchor").off().on("click",function(e){e.preventDefault();var i={};if(t(this).hasClass("spaformLink")||(i.Title=t(this).text().toUpperCase(),i.downloadLink=r(this)),i.copyLink=a(this),t(this).hasClass("iframeLink"))i.link=t(this).attr("iframeLink");else if(t(this).hasClass("imageLink"))i.imagePath=t(this).attr("imageLink");else if(t(this).hasClass("spaformLink")){i.spaformLink=t(this).attr("spaformLink");var o=spaform.open({mode:"NewForm",listUrl:t(this).attr("spaformLink"),onCloseCallback:function(){-1!==window.location.href.toLowerCase().indexOf("&internalfilelink=")&&history.go(-1),t("#sfpClientView").empty(),t("#DeltaPlaceHolderMain").css("display","block"),t("#sideNavBox").css("display","block")},parentId:"spaform365"});o&&alert(o)}t("#sfpClientView").html(t("#"+u.HandleLinks.hoverFileRenderer).html());var s=n(i);ko.applyBindings(s,document.getElementById("internalFileDetails")),t("#sfpClientView").css({display:"block"}),t("#DeltaPlaceHolderMain").css("display","none"),t("#sideNavBox").css("display","none")})}function n(e){return{Title:ko.observable(e.Title),FilePath:ko.observable(e.link),DownloadLink:ko.observable(e.downloadLink),CopyLinkText:ko.observable("COPY LINK"),ShowCopyLink:ko.observable(!1),CopyLinkUrl:ko.observable(e.copyLink),ImagePath:ko.observable(e.imagePath),SpaFormLink:ko.observable(e.spaformLink),ToggleCopyLink:function(e,i){this.ShowCopyLink()?(this.ShowCopyLink(!1),this.CopyLinkText("COPY LINK")):(this.ShowCopyLink(!0),this.CopyLinkText("HIDE LINK"),t(i.target).closest(".ms-srch-hover-actions").find("textarea").focus().select(),t(i.target).closest(".ms-srch-hover-actions").find("textarea")[0].setSelectionRange(0,9999))},HoverClose:function(e,i){t("#sfpClientView").empty(),this.CopyLinkUrl(""),this.ShowCopyLink(!1),this.CopyLinkText("COPY LINK"),this.SpaFormLink(""),this.DownloadLink(""),this.Title(""),this.FilePath(""),-1!==window.location.href.toLowerCase().indexOf("&internalfilelink=")&&history.go(-1),t("#DeltaPlaceHolderMain").css("display","block"),t("#sideNavBox").css("display","block")}}}function a(e){var i="";return-1!=window.location.href.toLowerCase().toLowerCase().indexOf("&internalfilelink")&&(i=window.location.href.toLowerCase()),t(e).hasClass("iframeLink")?(i=t(e).attr("iframeLink").toLowerCase().split("&action")[0].replace(".aspx?sourcedoc=",".aspx?sourceurl="),-1!=t(e).attr("iframeLink").toLowerCase().indexOf("sourcedoc=")&&(i=window.location.href.toLowerCase().split("#itemview")[0]+"&InternalFileLink="+t(e).attr("iframeLink").toLowerCase().split("sourcedoc=")[1])):t(e).hasClass("imageLink")?i=window.location.href.toLowerCase().split("#itemview")[0]+"&InternalFileLink="+t(e).attr("imageLink").toLowerCase():t(e).hasClass("spaformLink")&&(i=window.location.href.toLowerCase().split("#itemview")[0]+"&InternalFileLink="+t(e).attr("spaformLink").toLowerCase()),i}function r(e){var i="";return t(e).hasClass("iframeLink")?(i=t(e).attr("iframeLink").toLowerCase().split("&action")[0].replace(".aspx?sourcedoc=",".aspx?sourceurl="),-1!=i.indexOf("_layouts/15/wopiframe.aspx?")?i=i.replace("_layouts/15/wopiframe.aspx?","_layouts/15/download.aspx?"):-1!=i.indexOf("_layouts/15/wopiframe2.aspx?")&&(i=i.replace("_layouts/15/wopiframe2.aspx?","_layouts/15/download.aspx?"))):t(e).hasClass("imageLink")&&(i=t(e).attr("downloadLink").toLowerCase().split("&action")[0].replace(".aspx?sourcedoc=",".aspx?sourceurl="),-1!=i.indexOf("_layouts/15/wopiframe.aspx?")&&(i=i.replace("_layouts/15/wopiframe.aspx?","_layouts/15/download.aspx?"))),i}function o(){var e="";e=u.Utils.GetQueryStringParameter("InternalFileLink",window.location.toString()),void 0!==e&&""!==e?(t("a.iframeLink").each(function(i){if(-1!=decodeURIComponent(t(this).attr("iframeLink")).toLowerCase().indexOf(e.toLowerCase()))return t(this).trigger("click"),!1}),t("a.imageLink").each(function(i){if(-1!=decodeURIComponent(t(this).attr("imageLink")).toLowerCase().indexOf(e.toLowerCase()))return t(this).trigger("click"),!1}),t("a.spaformLink").each(function(i){if(-1!=decodeURIComponent(t(this).attr("spaformLink")).toLowerCase().indexOf(e.toLowerCase()))return t(this).trigger("click"),!1})):(t("#sfpClientView").empty(),t("#DeltaPlaceHolderMain").css("display","block"),t("#sideNavBox").css("display","block"))}function s(e){var i="",n=t("<a>",{href:e})[0],a=n.pathname.substring(0,n.pathname.lastIndexOf("/"));return a=a.substring(0,a.lastIndexOf("/")+1),-1!=n.pathname.indexOf(".xls")||-1!=n.pathname.indexOf(".xlsm")||-1!=n.pathname.indexOf(".xlsx")?a+="_layouts/15/WopiFrame2.aspx?sourcedoc=":a+="_layouts/15/WopiFrame.aspx?sourcedoc=",i=-1!=n.pathname.toLowerCase().indexOf("/lists/")&&-1!=n.pathname.toLowerCase().indexOf("/attachments/")?n.href.toLowerCase().split("/lists/")[0]+"/_layouts/15/WopiFrame2.aspx?sourcedoc="+n.pathname+l(n.pathname):window.navigator.userAgent.indexOf("MSIE ")>0?n.protocol+"//"+n.hostname+"/"+a+"/"+n.pathname+l(n.pathname):n.protocol+"//"+n.hostname+a+n.pathname+l(n.pathname),encodeURI(decodeURI(i))}function l(e){var t="",e=e.toLowerCase();return-1!=e.indexOf(".pdf")||-1!=e.indexOf(".pptx")||-1!=e.indexOf(".potx")||-1!=e.indexOf(".ppt")||-1!=e.indexOf(".doc")||-1!=e.indexOf(".docx")?t="&action=interactivePreview":-1==e.indexOf(".xls")&&-1==e.indexOf(".xlsm")&&-1==e.indexOf(".xlsx")||(t="&action=embedview"),t}var d=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),i=t.exec(location.search);return null===i?null:decodeURIComponent(i[1].replace(/\+/g," "))},c=d("Sandbox"),u=window.Medline=window.Medline||{};u.Utils=u.Utils||{},u.HandleLinks=u.HandleLinks||{},u.HandleLinks.hoverFileRenderer="internalFileDetailsWrapper",u.HandleLinks.UpdateContentLinks=function(e){window.APPPART.isAppPart=!1,window.APPPART.setitemview(),c||t("a",e).each(function(e){var i=t(this).attr("href");if(void 0!==i&&!1!==i&&-1!=i.toLowerCase().indexOf("https://collaboration.medline.com")&&-1!=i.toLowerCase().indexOf("_layouts/15/wopiframe")&&-1!=i.toLowerCase().indexOf("&action=")){var n=i.toLowerCase().split("?sourcedoc=")[1],a=i.split("&action=")[0]+l(n);t(this).attr("href","#").attr("iframeLink",encodeURI(decodeURI(a))),t(this).addClass("iframeLink handleThisAnchor")}else if(void 0===i||!1===i||-1==i.toLowerCase().indexOf("https://collaboration.medline.com")||-1!=i.toLowerCase().indexOf(".aspx")||-1!=i.toLowerCase().indexOf(".mp4")||-1==i.toLowerCase().indexOf(".pdf")&&-1==i.toLowerCase().indexOf(".pptx")&&-1==i.toLowerCase().indexOf(".potx")&&-1==i.toLowerCase().indexOf(".ppt")&&-1==i.toLowerCase().indexOf(".doc")&&-1==i.toLowerCase().indexOf(".docx")&&-1==i.toLowerCase().indexOf(".xls")&&-1==i.toLowerCase().indexOf(".xlsm")&&-1==i.toLowerCase().indexOf(".xlsx"))void 0!==i&&!1!==i&&-1!=i.toLowerCase().indexOf("https://collaboration.medline.com")&&-1==i.toLowerCase().indexOf(".aspx")&&-1==i.toLowerCase().indexOf(".mp4")&&null!=i.toLowerCase().match(/\.(jpeg|jpg|gif|png|jfif|exif|tiff|gif|bmp)$/)?(t(this).attr("href","#").attr("imageLink",i).attr("downloadLink",s(i)),t(this).addClass("imageLink handleThisAnchor")):void 0!==i&&!1!==i&&-1!=i.toLowerCase().indexOf(".aspx")&&-1!=i.toLowerCase().indexOf("/sitepages/")&&-1!=i.toLowerCase().indexOf(_spPageContextInfo.webAbsoluteUrl.toLowerCase())?t(this).attr("target","_self"):void 0!==i&&!1!==i&&-1!=i.toLowerCase().indexOf("mailto:")?t(this).attr("target",""):void 0!==i&&!1!==i&&spaform.checkUrl(i)?(t(this).attr("href","#").attr("spaformLink",i),t(this).addClass("spaformLink handleThisAnchor")):void 0!==i&&!1!==i&&(t(this).attr("href","#").attr("externalLink",i),t(this).addClass("externalLink"));else{var a=s(i);t(this).attr("href","#").attr("iframeLink",a),t(this).addClass("iframeLink handleThisAnchor")}}),i(),o()};var d=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),i=t.exec(location.search);return null===i?null:decodeURIComponent(i[1].replace(/\+/g," "))};if(!c){!function(e){var t=document.createElement("style");document.body.appendChild(t),t.innerHTML=e}(e);document.querySelector("#spaform365-attachments").insertAdjacentHTML("afterbegin",'<div id="attachment-preview">    <div id="internalFileDetailsWrapper" style="display:none;">\n      <div id="internalFileDetails">\n        <div class="ms-srch-hover-innerContainer2">\n          <div class="ms-srch-hover-actions">\n            \x3c!-- ko if: DownloadLink --\x3e\n              <div class="ms-srch-hover-action">\n                <a class="ms-uppercase download" data-bind="attr: {href: DownloadLink }">DOWNLOAD</a>\n              </div>\n            \x3c!-- /ko --\x3e\n            <div class="ms-srch-hover-action copyLinkContainer">\n              <b><span data-bind="text:Title"></span></b>\n            </div>\n            <div class="ms-srch-hover-close">\n              <a class="ms-uppercase" href="javascript:void(0);" title="Close panel" data-bind="click:HoverClose">CLOSE</a>\n            </div>\n            <div id="linkurlplaceholder" class="ms-srch-hover-copylinkinner" data-bind="css:{showcopylinkinner : ShowCopyLink(),  hidecopylinkinner: !ShowCopyLink()}">\n              <div class="copyLinkMessage">Note : This link is for internal use only.</div>\n              <textarea id="copyDocumentLink" rows="3" readonly="true" data-bind="textInput:CopyLinkUrl,value: CopyLinkUrl"></textarea>\n            </div>\n          </div>\n          \x3c!-- ko if: ImagePath --\x3e\n            <img class="intranetImageHolder" data-bind="attr: {src: ImagePath }" alt="Intranet Image" />\n          \x3c!-- /ko --\x3e\n          \x3c!-- ko if: FilePath --\x3e\n            <iframe data-bind="attr: {src: FilePath }" scrolling="no" frameborder="0px" class="ms-srch-hover-viewer" style="display: block;"></iframe>\n          \x3c!-- /ko --\x3e\n        </div>\n      </div>\n    </div>\n  </div>')}}),define("filebox",["text!./filebox.xml","../Runtime/source/syscomponents/filebox-apppart","../Runtime/source/syscomponents/filebox-utils","../Runtime/source/syscomponents/filebox-handlelinks"],function(e){function t(e){var t=this;this.params=e,this.internalName=e?e.InternalName:"";var i=e.parentContext().spaform,n=i.runtime;this.readonly=n.dataContext(e.namespace).readonly,this.designmode=n.designMode,this.title=ko.observable(e?e.Title:""),this.description=ko.observable(e&&e.Description&&e.Description.length>0?e.Description:"click to add file..."),this.required=ko.observable(!(!e||!e.Required)&&e.Required),this.readonlyfield=ko.observable(!(!e||!e.ReadOnlyField)&&e.ReadOnlyField),this.prefix=ko.observable(e&&e.Filter?e.Filter:""),this.value=ko.observable({results:[]}).extend({namespace:e}),this.results=ko.observableArray([]);var a=(i.form._.attachmentsmap,function(){setTimeout(function(){window.Medline.HandleLinks.UpdateContentLinks("#formContainer")},500)});this.processValue=function(i){i||(i={}),i&&!i.results&&(i.results=[]);var n=$.grep(i.results,function(e,i){return e.prefix==t.prefix()});this.results(this.$results(n)),1==e.PreviewAttachments&&a()},this.processValue(this.value()),this.value.subscribe(function(e){this.processValue(e)},this),ko.validation&&this.results.extend({required:this.required()}),this.enableValue=ko.pureComputed(function(){return this.$enabled()?"":"is-disabled"},this),this.showValue=ko.pureComputed(function(){return this.$enabled()},this),this.enableRequired=ko.pureComputed(function(){return this.required()?"is-required":""},this),this.showTitle=ko.pureComputed(function(){return!!(this.title()&&this.title().length>0)},this),this.addFile=function(){i.list.item.upload().done(function(e){var i=t.value(),n={newFileName:e,oldFileName:"",url:"",prefix:t.prefix()};i.results.push(n),t.value(i)})}}return function(e){var t=function(){function e(e){this._container=e,this._peoplePickerMenu=this._container.querySelector(".ms-PeoplePicker-results"),this._peoplePickerSearch=this._container.querySelector(".ms-TextField-field"),this._peoplePickerSearchBox=this._container.querySelector(".ms-PeoplePicker-searchBox"),this._selectedPeople=this._container.querySelector(".ms-PeoplePicker-selectedPeople")}return e.prototype._clickHandler=function(e){},e}();e.FilePicker=t}(fabric||(fabric={})),function(){this.$enabled=function(){return!this.readonly()&&!this.readonlyfield()},this.$init=function(e){var t=e.querySelector(".ms-PeoplePicker"),i=this;if(this.fabricObject=new fabric.FilePicker(t),i.fabricObject._filePickerIcon=i.fabricObject._container.querySelector(".ms-Icon--Attach"),ko.validation){var n=ko.validation.insertValidationMessage(this.fabricObject._container);ko.applyBindingsToNode(n,{validationMessage:this.results}),ko.applyBindingsToNode(this.fabricObject._container,{validationElement:this.results}),ko.applyBindingsToNode(this.fabricObject._filePickerIcon,{validationElement:this.results})}},this.$results=function(e){var t=[];return e.forEach(function(e,i){t.push({oldFileName:e.oldFileName,newFileName:e.newFileName,prefix:e.prefix,url:ko.pureComputed(function(){return e.url}),showText:ko.pureComputed(function(){return!(e.url&&e.url.length>0)},this),showLink:ko.pureComputed(function(){return!!(e.url&&e.url.length>0)},this),parent:this,onremove:function(){var e=this.parent.value(),t=this,i=$.grep(e.results,function(e,i){return e.oldFileName==t.oldFileName&&e.newFileName==t.newFileName});i[0].newFileName="",i[0].url="",i[0].prefix="deleted",this.parent.value(e)},jsonObject:e})},this),t}}.call(t.prototype),t.prototype.schema={Params:{name:"",namespace:"listItem",promoted:!0,Filter:"",PreviewAttachments:!0,InternalName:"",Title:"",AllowMultipleValues:!1,Description:"click to add file...",ReadOnlyField:!1,FieldTypeKind:0,Required:!1},
Permalink:"https://spaforms365.com/docs/syslib-filebox/",ListColumns:{mwp_Attachments:'<Field Type="Note" DisplayName="Attachments Map" Group="_Hidden" EnforceUniqueValues="FALSE" Required="FALSE" ID="{17117ed8-0696-4031-b721-2ef99de31109}" Name="mwp_Attachments" StaticName="mwp_Attachments" Sortable="FALSE" RichText="FALSE" RichTextMode="Compatible" IsolateStyles="FALSE" AppendOnly="FALSE" UnlimitedLengthInDocumentLibrary="FALSE" NumLines="6" SourceID="{daf8e407-d019-4c86-ba35-822c1763ac52}" Version="1" />'},Connections:{ListItem:["Attachments"]}},{viewModel:t,template:e}});